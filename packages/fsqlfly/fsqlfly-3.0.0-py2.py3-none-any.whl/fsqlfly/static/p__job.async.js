(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{SiJX:function(e,t,a){"use strict";a.r(t);a("Mwp2");var n=a("VXEj"),l=(a("IzEo"),a("bx4M")),r=(a("MXD1"),a("CFYs")),c=(a("lUTK"),a("BvKs")),i=(a("qVdP"),a("jsC+")),s=(a("+L6B"),a("2/Rp")),o=(a("5NDa"),a("5rEg")),m=(a("7Kak"),a("9yH6")),u=(a("2qtc"),a("kLXV")),p=(a("5Dmo"),a("3S7+")),d=(a("+BJd"),a("mr32")),f=(a("Telt"),a("Tckk")),E=(a("miYZ"),a("tsqr")),h=a("p0pE"),v=a.n(h),g=a("2Taf"),N=a.n(g),y=a("vZ4D"),k=a.n(y),I=a("l4Ni"),b=a.n(I),C=a("ujKo"),R=a.n(C),x=a("MhPg"),T=a.n(x),j=a("q1tI"),w=a.n(j),S=a("MuoO"),O=a("8Skl"),B=a("WsrF"),D=(a("XlDN"),a("rLCj")),L=a("4NGg"),F=a.n(L),M=a("c+yx");function U(e){return function(){var t,a=R()(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()){var n=R()(this).constructor;t=Reflect.construct(a,arguments,n)}else t=a.apply(this,arguments);return b()(this,t)}}var G="job",J=function(e){T()(a,e);var t=U(a);function a(){var e;return N()(this,a),(e=t.apply(this,arguments)).state={search:"",tag:0},e.doRefresh=function(){(0,e.props.dispatch)({type:"".concat(G,"/fetch")})},e.stopRunTerminal=function(t){var a=e.props.dispatch;a({type:"".concat(G,"/run"),payload:v()({},t,{method:"cancel",model:G}),callback:function(e){e.success?(E.a.success("删除成功！"),a({type:"".concat(G,"/deleteOne"),payload:{id:t.id}})):E.a.error(e.msg)}})},e.getListContent=function(){var t=e.state,a=t.tag,n=t.search;return e.props.listBasicList.filter(function(e){return e.name.indexOf(n)>=0&&(0===a||e.namespaceId===a)})},e.getNamespace=function(t){if(void 0===t)return null;var a=e.props.namespaces.filter(function(e){return e.id===t});return 0===a.length?null:a[0]},e.getNamespaceAvatar=function(t){var a=e.getNamespace(t.namespaceId);return null===a?w.a.createElement(f.a,{alt:t.info,shape:"circle",size:"large"},t.name.substr(0,2)):w.a.createElement(f.a,{src:null===a?"":a.avatar,alt:t.info,shape:"circle",size:"large"})},e.getNamespaceTitle=function(t){var a=e.getNamespace(t);return null===a?w.a.createElement(d.a,null,"-"):w.a.createElement(p.a,{title:a.name,placement:"top"},w.a.createElement(d.a,null,Object(M.a)(a.name)))},e}return k()(a,[{key:"componentDidMount",value:function(){this.doRefresh()}},{key:"render",value:function(){var e=this,t=this.props,a=t.namespaces,d=t.loading,f=m.a.Group,E=m.a.Button,h=o.a.Search,v=this.state.search,g=w.a.createElement("div",{className:F.a.extraContent},w.a.createElement(s.a,{onClick:this.doRefresh,style:{marginRight:20}},w.a.createElement(D.a,null)),w.a.createElement(f,{defaultValue:null,onChange:function(t){return e.setState({tag:t.target.value})}},w.a.createElement(E,{className:F.a.namespaceButton,value:0},"全部"),a.length>0&&a.slice(0,8).map(function(e){return w.a.createElement(p.a,{title:e.name,placement:"left"},w.a.createElement(E,{className:F.a.namespaceButton,key:e.id,value:e.id},Object(M.a)(e.name)))}),a.length>8&&w.a.createElement(i.a,{className:F.a.namespaceButton,overlay:w.a.createElement(c.a,{onClick:function(t){var a=t.key;return e.setState({tag:a})}},a.slice(8,a.length+1).map(function(e){return w.a.createElement(c.a.Item,{key:e.id},w.a.createElement(p.a,{title:e.name,placement:"left"},w.a.createElement("span",null,Object(M.a)(e.name))))}))},w.a.createElement(s.a,null,"更多",w.a.createElement(O.a,null)))),w.a.createElement(h,{defaultValue:v,className:F.a.extraContentSearch,placeholder:"请输入名或者命名空间搜索",onSearch:function(t){return e.setState({search:t})}})),N=function(t){var a=t.data,n=(a.name,a.startTime),l=a.endTime,c=a.status,i=a.namespaceId,s=a.duration;return w.a.createElement("div",{className:F.a.listContent},w.a.createElement("div",{className:F.a.listContentItem},e.getNamespaceTitle(i)),w.a.createElement("div",{className:F.a.listContentItem},w.a.createElement("span",null,"开始时间"),w.a.createElement(p.a,{placement:"top",title:s},w.a.createElement("p",null,n))),w.a.createElement("div",{className:F.a.listContentItem},w.a.createElement("span",null,"结束时间"),w.a.createElement("p",null,"-"===l?"0000-00-00 00:00:00":l)),w.a.createElement("div",{className:F.a.listContentItem},w.a.createElement(r.a,{type:"circle",percent:100,status:"RUNNING"===c?"success":"FAILED"===c?"exception":"normal",strokeWidth:1,width:50,style:{width:180},format:function(){return c}})))},y=function(t){var a=t.item;return w.a.createElement(i.a,{overlay:"RUNNING"===a.status||void 0!==a.url?w.a.createElement(c.a,{onClick:function(t){return function(t,a){"stop"==t?u.a.confirm({title:"停止Flink任务",content:"确定停止Flink任务吗？",okText:"确认",cancelText:"取消",onOk:function(){return e.stopRunTerminal(a)}}):window.location.href=t}(t.key,a)}},"RUNNING"===a.status&&w.a.createElement(c.a.Item,{key:"stop"},"停止"),void 0!==a.url&&w.a.createElement(c.a.Item,{key:a.url},"连接")):w.a.createElement("span",null)},w.a.createElement("a",null,"更多 ",w.a.createElement(O.a,null)))};return w.a.createElement(w.a.Fragment,null,w.a.createElement("div",{className:F.a.standardList},w.a.createElement(l.a,{className:F.a.listCard,bordered:!1,title:"Flink Job",style:{marginTop:24},bodyStyle:{padding:"0 32px 40px 32px"},extra:g},w.a.createElement(n.a,{size:"large",rowKey:"id",loading:d,dataSource:this.getListContent(),renderItem:function(t){return w.a.createElement(n.a.Item,{actions:[w.a.createElement(p.a,{title:t.fullName,placement:"left"},w.a.createElement("a",{href:t.detailUrl,target:"_blank"},"详情")),w.a.createElement(y,{key:"more",item:t})]},w.a.createElement(n.a.Item.Meta,{title:w.a.createElement(p.a,{title:t.name,placement:"left"},w.a.createElement("a",{href:t.detailUrl,target:"_blank"},Object(M.a)(t.name))),avatar:e.getNamespaceAvatar(t),description:w.a.createElement(p.a,{title:void 0!==t.info?t.info:""},w.a.createElement("span",null,Object(M.a)(t.info)))}),w.a.createElement(N,{data:t}))}}))))}}]),a}(j.Component),K=B.a.create()(J);t.default=Object(S.connect)(function(e){var t=e.job,a=e.loading;return{listBasicList:t.list,namespaces:t.dependence,loading:a.models.namespace}})(K)}}]);