(this["webpackJsonpmeme-manager"]=this["webpackJsonpmeme-manager"]||[]).push([[0],{173:function(e,t,r){e.exports=r(342)},341:function(e,t,r){},342:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(3),c=r.n(o),u=r(16),l=r(51),s=r(4),i=r.n(s),p=r(11),m=r(7),f=r(351),g=r(348),d=r(14),v=r(69),b=r(345),h=r(143),E=r(169),x=r(144),y=r(113),O=r(170),w=r(347),j=function(e){function t(e){var r;return Object(h.a)(this,t),(r=Object(E.a)(this,Object(x.a)(t).call(this,e))).handleFileChoose=function(e){var t=e.target.files[0];console.log("Upload: recv file: %o",{file:t}),r.setState({file:t}),r.props.onChange(t)},r.state={file:r.props.value},r}return Object(O.a)(t,e),Object(y.a)(t,null,[{key:"getDerivedStateFromProps",value:function(e){return console.log("Upload getDerivedStateFromProps: %o",{nextProps:e}),"value"in e?{file:e.value||void 0}:null}}]),Object(y.a)(t,[{key:"render",value:function(){var e=this.state.file;return n.a.createElement("div",null,void 0===e?n.a.createElement(w.a,{type:"file",onChange:this.handleFileChoose}):n.a.createElement("img",{src:URL.createObjectURL(e),alt:e.name,style:{width:"300px"}}))}}]),t}(n.a.Component),k=r(352),S=r(353);function C(e){var t=e.value,r=e.onChange,a=t,o=function(e,t){var n=t.target.value||"",o=Object(l.a)(a);o[e]=n,r(o)},c=a.map((function(e,t){return n.a.createElement("div",{key:t},n.a.createElement(w.a,{value:e,placeholder:"Tag",style:{width:"80%",marginBottom:"10px"},onChange:function(e){o(t,e)}}),a.length>1?n.a.createElement(k.a,{className:"dynamic-delete-button",onClick:function(){return e=t,void r([].concat(Object(l.a)(a.slice(0,e)),Object(l.a)(a.slice(e+1))));var e}}):null)}));return n.a.createElement("div",null,c,n.a.createElement(d.a,{type:"dashed",onClick:function(){r([].concat(Object(l.a)(a),[""]))}},n.a.createElement(S.a,null)," Add Select Item"))}function I(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new URL(e),a=0,n=Object.entries(t);a<n.length;a++){var o=Object(m.a)(n[a],2),c=o[0],u=o[1];r.searchParams.append(c,u)}return console.log("get: %o",{urlO:r}),fetch(r.href,{mode:"cors",credentials:"include"})}function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log("post: %o",{url:e,body:t}),fetch(e,{method:"POST",body:JSON.stringify(t),headers:new Headers({"Content-Type":"application/json"}),mode:"cors",credentials:"include"})}function A(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new FormData,a=0,n=Object.entries(t);a<n.length;a++){var o=Object(m.a)(n[a],2),c=o[0],u=o[1];r.append(c,u)}return console.log("postForm: %o",{url:e,formData:r}),fetch(e,{method:"POST",body:r,mode:"cors",credentials:"include"})}function G(e){var t={},r=!0,a=!1,n=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var u=o.value;t[u]=void 0===t[u]?1:t[u]+1}}catch(l){a=!0,n=l}finally{try{r||null==c.return||c.return()}finally{if(a)throw n}}return t}var T=v.a.Option;function D(e){var t=e.groups,r=e.onSubmit,a=b.a.useForm(),o=Object(m.a)(a,1)[0],c=function(e){return e.filter((function(e){return""!==e}))},l=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n,o,u,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=c(r),n=G(a),o=0,u=Object.entries(n);case 3:if(!(o<u.length)){e.next=10;break}if(l=Object(m.a)(u[o],2),s=l[0],!(l[1]>1)){e.next=7;break}throw Error("\u6807\u7b7e\u201c".concat(s,"\u201d\u91cd\u590d"));case 7:o++,e.next=3;break;case 10:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return n.a.createElement(b.a,Object.assign({name:"addImageForm",form:o},{labelCol:{span:4},wrapperCol:{span:16}},{initialValues:{group:"all",tags:[""]},onFinish:function(e){var t=Object(u.a)({},e,{tags:c(e.tags)});r(t),o.resetFields()},onFinishFailed:function(e){console.error(e)}}),n.a.createElement(b.a.Item,{label:"\u56fe\u7247",name:"image",rules:[{required:!0,message:"\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u56fe\u7247"}]},n.a.createElement(j,null)),n.a.createElement(b.a.Item,{label:"\u7ec4",name:"group",rules:[{required:!0,message:"\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u7ec4"}]},n.a.createElement(v.a,null,t.map((function(e){return n.a.createElement(T,{key:e,value:e},e)})))),n.a.createElement(b.a.Item,{label:"\u6807\u7b7e",name:"tags",rules:[{validator:l}]},n.a.createElement(C,null)),n.a.createElement(b.a.Item,{wrapperCol:{offset:4,span:16}},n.a.createElement(d.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),n.a.createElement(d.a,{htmlType:"button",onClick:function(){o.resetFields()}},"\u91cd\u7f6e")))}var R=r(346);function M(e){var t=e.buttonItem,r=e.title,o=e.wrappedForm,c=e.onSubmit,u=Object(a.useState)(!1),l=Object(m.a)(u,2),s=l[0],i=l[1];return n.a.createElement("div",null,n.a.createElement(t.type,Object.assign({},t.props,{onClick:function(){console.log("click FormModalButton Button"),i(!0)}})),n.a.createElement(R.a,{title:r,visible:s,onCancel:function(){i(!1)},footer:null},n.a.createElement(o.type,Object.assign({},o.props,{onSubmit:function(e){i(!1),c(e)}}))))}var P=v.a.Option;function z(e){var t=e.initialRange,r=e.initialTag,o=e.onSearch,c=e.onReset,u=Object(a.useState)(t),l=Object(m.a)(u,2),s=l[0],i=l[1],p=Object(a.useState)(r),f=Object(m.a)(p,2),g=f[0],b=f[1];return n.a.createElement("div",{style:{display:"flex"}},n.a.createElement(v.a,{style:{minWidth:"6em"},value:s,onSelect:i},n.a.createElement(P,{value:"all"},"\u5168\u90e8"),n.a.createElement(P,{value:"group"},"\u7ec4\u5185")),n.a.createElement(w.a.Search,{value:g,onChange:function(e){return b(e.target.value)},onSearch:function(e){return o(s,e)},enterButton:!0}),n.a.createElement("div",{style:{marginLeft:"10px"}},n.a.createElement(d.a,{type:"primary",onClick:function(){i("all"),b(""),c()}},"\u91cd\u7f6e")))}var B=r(344);function N(e){var t=e.onSubmit,r=b.a.useForm(),a=Object(m.a)(r,1)[0];return n.a.createElement(b.a,Object.assign({form:a},{labelCol:{span:4},wrapperCol:{span:16}},{onFinish:function(e){t(e),a.resetFields()},onFinishFailed:function(e){console.error(e)}}),n.a.createElement(b.a.Item,{label:"\u7ec4\u540d",name:"name",rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u7ec4\u540d"}]},n.a.createElement(w.a,{placeholder:"Group"})),n.a.createElement(b.a.Item,{wrapperCol:{offset:4,span:16}},n.a.createElement(d.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))}var W=r(65),_=r(343),L=r(354),J=r(355);function U(e){var t=e.groups,r=e.onGroupDelete,o=e.onGroupRename,c=Object(a.useState)(!1),u=Object(m.a)(c,2),l=u[0],s=u[1];return n.a.createElement("div",null,n.a.createElement(d.a,{size:"small",onClick:function(){s(!0)}},"\u7f16\u8f91"),n.a.createElement(R.a,{title:"\u7f16\u8f91\u7ec4",visible:l,onCancel:function(){s(!1)},footer:null},n.a.createElement(q,{groups:t,onGroupDelete:function(e){s(!1),r(e)},onGroupRename:function(e,t){s(!1),o(e,t)}})))}function q(e){var t=e.groups,r=e.onGroupDelete,o=e.onGroupRename,c=Object(a.useState)({}),l=Object(m.a)(c,2),s=l[0],i=l[1];return n.a.createElement("div",null,t.map((function(e){return n.a.createElement("div",{style:{display:"flex",margin:"10px"},key:e},Object.keys(s).includes(e)?n.a.createElement(w.a,{style:{width:"50%"},value:s[e],onChange:function(t){return r=e,a=t.target.value,void i(Object(u.a)({},s,Object(W.a)({},r,a)));var r,a}}):n.a.createElement(w.a,{style:{width:"50%"},value:e,disabled:!0}),"all"!==e&&!Object.keys(s).includes(e)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(d.a,{style:{marginLeft:"20px"},onClick:function(){return i(Object(u.a)({},s,Object(W.a)({},e,e)))}},"\u91cd\u547d\u540d"),n.a.createElement(_.a,{title:"\u786e\u5b9a\u5220\u9664\u7ec4\u201c".concat(e,"\u201d\uff1f\u6ce8\u610f\uff0c\u6240\u6709\u7ec4\u5185\u56fe\u7247\u4e5f\u4f1a\u4e00\u5e76\u5220\u9664\u3002"),onConfirm:function(){return r(e)},okText:"Yes",cancelText:"No"},n.a.createElement(d.a,{style:{marginLeft:"20px"},type:"danger"},"\u5220\u9664"))),"all"!==e&&Object.keys(s).includes(e)&&n.a.createElement(n.a.Fragment,null,n.a.createElement(d.a,{icon:n.a.createElement(L.a,null),onClick:function(){return o(e,s[e])}}),n.a.createElement(d.a,{icon:n.a.createElement(J.a,null),onClick:function(){return function(e){var t=Object(u.a)({},s);delete t[e],i(t)}(e)}})))})))}var H=v.a.Option;function K(e){var t=e.groups,r=e.currentGroup,a=e.onGroupSelect,o=e.onGroupAdd,c=e.onGroupDelete,u=e.onGroupRename;return n.a.createElement(v.a,{style:{minWidth:120},placeholder:"group",value:r,onSelect:a,dropdownRender:function(e){return n.a.createElement("div",null,e,n.a.createElement(B.a,{style:{margin:"4px 0"}}),n.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",padding:"8px"}},n.a.createElement(U,{groups:t,onGroupDelete:c,onGroupRename:u}),n.a.createElement(M,{buttonItem:n.a.createElement(d.a,{size:"small"},"\u65b0\u5efa"),title:"\u6dfb\u52a0\u7ec4",wrappedForm:n.a.createElement(N,null),onSubmit:o})))}},t.map((function(e){return n.a.createElement(H,{key:e,value:e},e)})))}function V(e){var t=e.groups,r=e.currentGroup,a=e.searchInfo,o=e.onGroupSelect,c=e.onGroupAdd,u=e.onGroupDelete,l=e.onGroupRename,s=e.onImageAdd,i=e.onSearch,p=e.onReset;return n.a.createElement("div",{style:{display:"flex"}},n.a.createElement("div",null,"\u7ec4\uff1a",n.a.createElement(K,{groups:t,currentGroup:r,onGroupSelect:o,onGroupAdd:c,onGroupDelete:u,onGroupRename:l})),n.a.createElement("div",{style:{flexGrow:"1",marginLeft:"100px"}},n.a.createElement(z,{initialRange:a.range,initialTag:a.tag,onSearch:i,onReset:p})),n.a.createElement("div",{style:{marginLeft:"100px"}},n.a.createElement(M,{buttonItem:n.a.createElement(d.a,{type:"primary"},"\u6dfb\u52a0"),title:"\u6dfb\u52a0\u56fe\u7247",wrappedForm:n.a.createElement(D,{groups:t}),onSubmit:s})))}var X=r(349),Y=r(350),$=R.a.confirm;function Q(e){var t=e.tags,r=e.onTagDelete;return n.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},t.map((function(e){return n.a.createElement(Y.a,{key:e,overlay:n.a.createElement(X.a,null,n.a.createElement(X.a.Item,null,n.a.createElement("div",{onClick:function(){return t=e,void $({title:"\u786e\u5b9a\u5220\u9664\u8be5\u6807\u7b7e\uff1f",content:"\u6ce8\u610f\uff01\u6807\u7b7e\u5220\u9664\u540e\u65e0\u6cd5\u6062\u590d\uff01",onOk:function(){r(t)},onCancel:function(){}});var t}},"\u5220\u9664\u6807\u7b7e"))),trigger:["contextMenu"],onContextMenu:function(e){return e.stopPropagation()}},n.a.createElement("div",{className:"tag"},e))})))}function Z(e){var t=e.tags,r=e.onSubmit,a=b.a.useForm(),o=Object(m.a)(a,1)[0],c=function(e){return e.filter((function(e){return""!==e}))},u=function(){var e=Object(p.a)(i.a.mark((function e(r,a){var n,o,u,l,s,p,f,g,d,v,b,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(n=c(a)).length){e.next=3;break}throw Error("\u5fc5\u987b\u81f3\u5c11\u8bbe\u7f6e\u4e00\u4e2a\u6807\u7b7e");case 3:o=!0,u=!1,l=void 0,e.prev=6,s=n[Symbol.iterator]();case 8:if(o=(p=s.next()).done){e.next=15;break}if(f=p.value,!t.includes(f)){e.next=12;break}throw Error("\u6807\u7b7e\u201c".concat(f,"\u201d\u5df2\u5b58\u5728"));case 12:o=!0,e.next=8;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),u=!0,l=e.t0;case 21:e.prev=21,e.prev=22,o||null==s.return||s.return();case 24:if(e.prev=24,!u){e.next=27;break}throw l;case 27:return e.finish(24);case 28:return e.finish(21);case 29:g=G(n),d=0,v=Object.entries(g);case 31:if(!(d<v.length)){e.next=38;break}if(b=Object(m.a)(v[d],2),h=b[0],!(b[1]>1)){e.next=35;break}throw Error("\u6807\u7b7e\u201c".concat(h,"\u201d\u91cd\u590d"));case 35:d++,e.next=31;break;case 38:case"end":return e.stop()}}),e,null,[[6,17,21,29],[22,,24,28]])})));return function(t,r){return e.apply(this,arguments)}}();return n.a.createElement(b.a,Object.assign({form:o},{labelCol:{span:4},wrapperCol:{span:20}},{initialValues:{tags:[""]},onFinish:function(e){var t=c(e.tags);r(t),o.resetFields(),console.log("Success:",e)},onFinishFailed:function(e){console.error("Failed:",e)}}),n.a.createElement(b.a.Item,{label:"\u6807\u7b7e",name:"tags",rules:[{validator:u}]},n.a.createElement(C,null)),n.a.createElement(b.a.Item,{wrapperCol:{offset:4,span:20}},n.a.createElement(d.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))}var ee=v.a.Option;function te(e){var t=e.groups,r=e.group,a=e.onSubmit;return n.a.createElement(b.a,Object.assign({},{labelCol:{span:4},wrapperCol:{span:16}},{initialValues:{group:r},onFinish:function(e){a(e.group)},onFinishFailed:function(e){console.error(e)}}),n.a.createElement(b.a.Item,{label:"\u79fb\u81f3\u7ec4",name:"group",rules:[{required:!0,message:"\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u7ec4"}]},n.a.createElement(v.a,null,t.map((function(e){return n.a.createElement(ee,{key:e,value:e},e)})))),n.a.createElement(b.a.Item,{wrapperCol:{offset:4,span:16}},n.a.createElement(d.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))}function re(e){var t=e.groups,r=e.group,o=e.onImageMove,c=Object(a.useState)(!1),u=Object(m.a)(c,2),l=u[0],s=u[1];return n.a.createElement("div",null,n.a.createElement("div",{onClick:function(){s(!0)}},"\u79fb\u81f3\u7ec4"),n.a.createElement(R.a,{title:"\u79fb\u81f3\u7ec4",visible:l,onCancel:function(){s(!1)},footer:null},n.a.createElement(te,{groups:t,group:r,onSubmit:function(e){s(!1),o(e)}})))}var ae={BACKEND_PREFIX:"http://127.0.0.1:5000"},ne=R.a.confirm,oe=ae.BACKEND_PREFIX;function ce(e){var t=e.metadata,r=e.groups,a=e.onImageDelete,o=e.onImageMove,c=e.onTagsAdd,u=e.onTagDelete,l="".concat(oe,"/api/images/?id=").concat(t.id),s=n.a.createElement(X.a,null,n.a.createElement(X.a.Item,null,n.a.createElement("div",{onClick:function(){window.open(l)}},"\u67e5\u770b\u56fe\u7247")),n.a.createElement(X.a.Item,null,n.a.createElement(M,{buttonItem:n.a.createElement("div",null,"\u6dfb\u52a0\u6807\u7b7e"),title:"\u6dfb\u52a0\u6807\u7b7e",wrappedForm:n.a.createElement(Z,{tags:t.tags}),onSubmit:function(e){return c(t.id,e)}})),n.a.createElement(X.a.Item,null,n.a.createElement(re,{groups:r,group:t.group||"all",onImageMove:function(e){return o(t.id,e)}})),n.a.createElement(X.a.Item,null,n.a.createElement("div",{onClick:function(){ne({title:"\u786e\u5b9a\u5220\u9664\u8be5\u56fe\u7247\uff1f",content:"\u6ce8\u610f\uff01\u56fe\u7247\u5220\u9664\u540e\u65e0\u6cd5\u6062\u590d\uff01",onOk:function(){a(t.id)},onCancel:function(){}})}},"\u5220\u9664\u56fe\u7247")));return n.a.createElement(Y.a,{overlay:s,trigger:["contextMenu"]},n.a.createElement("div",{className:"imageBox"},n.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignContent:"center",width:"250px",height:"250px",overflow:"hidden"}},n.a.createElement("img",{style:{maxWidth:"100%",margin:"auto"},src:l,alt:"img-".concat(t.id)})),n.a.createElement("div",{style:{width:"250px",minHeight:"50px",overflow:"hidden"}},n.a.createElement(Q,{tags:t.tags,onTagDelete:function(e){return u(t.id,e)}}))))}function ue(e){var t=e.imageMetaDatas,r=e.groups,a=e.onImageDelete,o=e.onImageMove,c=e.onTagsAdd,u=e.onTagDelete;return n.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",backgroundColor:"white",boxShadow:"2px 2px 5px #a0a0a0"}},t.map((function(e){return n.a.createElement(ce,{key:e.id,metadata:e,groups:r,onImageDelete:a,onImageMove:o,onTagsAdd:c,onTagDelete:u})})))}function le(){return n.a.createElement("div",{style:{width:"100%",height:"100px",backgroundColor:"#999999",textAlign:"center"}},"Footer")}var se=ae.BACKEND_PREFIX;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(341);c.a.render(n.a.createElement((function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),r=t[0],o=t[1],c=Object(a.useState)({current:1,pageSize:20,total:null}),s=Object(m.a)(c,2),d=s[0],v=s[1],b=Object(a.useState)({range:"all",tag:""}),h=Object(m.a)(b,2),E=h[0],x=h[1],y=Object(a.useState)(["all"]),O=Object(m.a)(y,2),w=O[0],j=O[1],k=Object(a.useState)("all"),S=Object(m.a)(k,2),C=S[0],G=S[1],T=function(){var e=Object(p.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I("".concat(se,"/api/groups/"));case 2:if(200===(t=e.sent).status){e.next=6;break}throw console.error("Error: %o",{resp:t}),new Error("resp status !== 200");case 6:return e.next=8,t.json();case 8:return r=e.sent,console.log("App fetch group: receive resp: %o",{respJSON:r}),e.abrupt("return",r.data);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(p.a)(i.a.mark((function e(t,r,a,n){var o,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={page:t,per_page:r,tag:a,group:"all"===n?"":n},e.next=3,I("".concat(se,"/api/images/"),o);case 3:if(200===(c=e.sent).status){e.next=7;break}throw console.error("Error: %o",{resp:c}),new Error("resp status !== 200");case 7:return e.next=9,c.json();case 9:return u=e.sent,console.log("App fetch imageMetaDatas: receive resp: %o",{respJSON:u}),e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})));return function(t,r,a,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(p.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App: refreshGroups"),e.prev=1,e.next=4,T();case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 11:j(["all"].concat(Object(l.a)(t)));case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(p.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App: refreshImageMetaDatas"),e.prev=1,e.next=4,D(d.current,d.pageSize,E.tag,C);case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 11:return o(t.data),v(Object(u.a)({},d,{total:t.pagination.total})),e.abrupt("return");case 14:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){R(),M()}),[]);var P=function(){var e=Object(p.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D(t,d.pageSize,E.tag,C);case 3:r=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 10:return o(r.data),v(Object(u.a)({},d,{current:t})),e.abrupt("return");case 13:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(p.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D(1,t,E.tag,C);case 3:r=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 10:return o(r.data),v(Object(u.a)({},d,{current:1,pageSize:t})),e.abrupt("return");case 13:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(p.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(t),e.prev=1,e.next=4,D(1,d.pageSize,E.tag,t);case 4:r=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 11:return o(r.data),v(Object(u.a)({},d,{current:1,total:r.pagination.total})),e.abrupt("return");case 14:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(p.a)(i.a.mark((function e(t){var r,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("App handleGroupAdd: %o",{values:t}),r=t.name,!w.includes(r)){e.next=5;break}return f.a.warn("\u65b0\u5efa\u7ec4\u5931\u8d25\uff1a\u201c".concat(r,"\u201d\u7ec4\u5df2\u5b58\u5728")),e.abrupt("return");case 5:return a={name:r},console.log("App POST body: %o",a),e.next=9,F("".concat(se,"/api/groups/add"),a);case 9:if(200===(n=e.sent).status){e.next=14;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u65b0\u5efa\u7ec4\u5931\u8d25"),console.error("Error: %o",{resp:n}),e.abrupt("return");case 14:return f.a.success("\u6210\u529f\u65b0\u5efa\u7ec4\u201c".concat(r,"\u201d")),console.log("Success: %o",{resp:n}),R(),e.abrupt("return");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleGroupAdd: %o",{name:t}),r={name:t},console.log("App POST body: %o",r),e.next=5,F("".concat(se,"/api/groups/delete"),r);case 5:if(200===(a=e.sent).status){e.next=10;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5220\u9664\u7ec4\u5931\u8d25"),console.error("Error: %o",{resp:a}),e.abrupt("return");case 10:return f.a.success("\u6210\u529f\u5220\u9664\u7ec4\u201c".concat(t,"\u201d")),console.log("Success: %o",{resp:a}),R(),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleGroupRename: %o",{old:t,new_:r}),a={name:t,new_name:r},console.log("App POST body: %o",a),e.next=5,F("".concat(se,"/api/groups/update"),a);case 5:if(200===(n=e.sent).status){e.next=10;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u91cd\u547d\u540d\u7ec4\u5931\u8d25"),console.error("Error: %o",{resp:n}),e.abrupt("return");case 10:return f.a.success("\u6210\u529f\u91cd\u547d\u540d\u7ec4\u201c".concat(t,"\u201d\u4e3a\u201c").concat(r,"\u201d")),console.log("Success: %o",{resp:n}),R(),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),L=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x({range:t,tag:r}),a="all"===t?"all":C,e.prev=2,e.next=5,D(1,d.pageSize,r,a);case 5:n=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 12:return o(n.data),v(Object(u.a)({},d,{current:1,total:n.pagination.total})),e.abrupt("return");case 15:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,r){return e.apply(this,arguments)}}(),J=function(){var e=Object(p.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"all","",x({range:"all",tag:""}),e.prev=3,e.next=6,D(1,d.pageSize,"",C);case 6:t=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 13:return o(t.data),v(Object(u.a)({},d,{current:1,total:t.pagination.total})),e.abrupt("return");case 16:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(p.a)(i.a.mark((function e(t){var r,a,n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleImageAdd: %o",{values:t}),r=t.image,a=r.type.split("/")[1],n={image:r,metadata:JSON.stringify({img_type:a,tags:t.tags,group:"all"===t.group?null:t.group})},console.log("App post body: %o",n),e.next=7,A("".concat(se,"/api/images/add"),n);case 7:if(200===(o=e.sent).status){e.next=12;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u6dfb\u52a0\u56fe\u7247\u5931\u8d25"),console.error("Error: %o",{resp:o}),e.abrupt("return");case 12:return f.a.success("\u6dfb\u52a0\u56fe\u7247\u6210\u529f"),console.log("Success: %o",{resp:o}),M(),e.abrupt("return");case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(p.a)(i.a.mark((function e(t){var r,a,n,c,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleImageDelete: %o",{id:t}),e.next=3,I("".concat(se,"/api/images/delete"),{id:t});case 3:if(200===(r=e.sent).status){e.next=8;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5220\u9664\u56fe\u7247\u5931\u8d25"),console.error("Error: %o",{resp:r}),e.abrupt("return");case 8:return f.a.success("\u5220\u9664\u56fe\u7247\u6210\u529f"),console.log("Success: %o",{resp:r}),a=d.current,n=d.pageSize,c=d.total,l=c%n===1&&1!==a?a-1:a,e.prev=12,e.next=15,D(l,n,E.tag,C);case 15:s=e.sent,e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(12),f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5237\u65b0\u5931\u8d25"),e.abrupt("return");case 22:o(s.data),v(Object(u.a)({},d,{current:l,total:s.pagination.total}));case 24:case"end":return e.stop()}}),e,null,[[12,18]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleImageMoveTo: %o",{imageId:t,group:r}),a={id:t,group:"all"===r?null:r},e.next=4,F("".concat(se,"/api/images/update"),a);case 4:if(200===(n=e.sent).status){e.next=9;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u79fb\u52a8\u56fe\u7247\u5931\u8d25"),console.error("Error: %o",{resp:n}),e.abrupt("return");case 9:return f.a.success("\u6210\u529f\u79fb\u52a8\u56fe\u7247\u81f3\u7ec4\u201c".concat(r,"\u201d")),console.log("Success: %o",{resp:n}),M(),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),K=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleTagsAdd: %o",{imageId:t,tags:r}),a={image_id:t,tags:r},console.log("App POST body: %o",a),e.next=5,F("".concat(se,"/api/tags/add"),a);case 5:if(200===(n=e.sent).status){e.next=10;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u6dfb\u52a0\u6807\u7b7e\u5931\u8d25"),console.error("Error: %o",{resp:n}),e.abrupt("return");case 10:return f.a.success("\u6dfb\u52a0\u6807\u7b7e\u6210\u529f"),console.log("Success: %o",{resp:n}),M(),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),X=function(){var e=Object(p.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("App handleTagDelete: %o",{imageId:t,tag:r}),a={image_id:t,tag:r},console.log("App POST body: %o",a),e.next=5,F("".concat(se,"/api/tags/delete"),a);case 5:if(200===(n=e.sent).status){e.next=10;break}return f.a.error("\u7f51\u7edc\u5f02\u5e38\uff0c\u5220\u9664\u6807\u7b7e\u5931\u8d25"),console.error("Error: %o",{resp:n}),e.abrupt("return");case 10:return f.a.success("\u5220\u9664\u6807\u7b7e\u6210\u529f"),console.log("Success: %o",{resp:n}),M(),e.abrupt("return");case 14:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();return n.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minHeight:"100vh",backgroundColor:"#eeeeee"}},n.a.createElement("div",{style:{flexGrow:"1",maxWidth:"1010px"}},n.a.createElement("div",{style:{marginTop:"10px",marginBottom:"10px"}},n.a.createElement(V,{groups:w,currentGroup:C,searchInfo:E,onGroupSelect:B,onGroupAdd:N,onGroupDelete:W,onGroupRename:_,onImageAdd:U,onSearch:L,onReset:J})),n.a.createElement(ue,{imageMetaDatas:r,groups:w,onImageDelete:q,onImageMove:H,onTagsAdd:K,onTagDelete:X}),n.a.createElement("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",marginBottom:"20px"}},n.a.createElement(g.a,Object.assign({},d,{showSizeChanger:!0,pageSizeOptions:["20","50","100","200"],onChange:function(e,t){return P(e)},onShowSizeChange:function(e,t){return z(t)}})))),n.a.createElement(le,null))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[173,1,2]]]);
//# sourceMappingURL=main.08a309e4.chunk.js.map