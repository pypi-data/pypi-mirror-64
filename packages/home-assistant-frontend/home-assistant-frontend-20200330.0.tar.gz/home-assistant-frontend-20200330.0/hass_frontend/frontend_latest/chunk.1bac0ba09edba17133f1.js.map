{"version":3,"sources":["webpack:///./src/components/dialog/ha-iron-focusables-helper.js","webpack:///./src/components/dialog/ha-paper-dialog.ts","webpack:///./src/panels/lovelace/editor/card-editor/hui-card-preview.ts","webpack:///./src/panels/lovelace/editor/card-editor/hui-dialog-delete-card.ts"],"names":["HaIronFocusablesHelper","getTabbableNodes","node","result","this","_collectTabbableNodes","IronFocusablesHelper","_sortByTabIndex","nodeType","Node","ELEMENT_NODE","_isVisible","children","element","tabIndex","_normalizedTabIndex","needsSort","push","localName","dom","getDistributedNodes","shadowRoot","root","i","length","paperDialogClass","customElements","get","haTabFixBehaviorImpl","_focusableNodes","define","mixinBehaviors","HTMLElement","_error","_this$_element","_element","tagName","constructor","super","_defineProperty","addEventListener","_cleanup","_config","config","hass","_hass","language","style","direction","computeRTL","error","_createCard","createErrorCardConfig","type","message","undefined","configValue","curConfig","setConfig","err","createCardElement","appendChild","removeChild","HuiDialogDeleteCard","_decorate","customElement","_initialize","_LitElement","F","[object Object]","args","d","kind","decorators","property","key","value","query","async","params","_params","_cardConfig","cardConfig","Object","isFrozen","deepFreeze","updateComplete","fireEvent","_dialog","html","localize","_close","_delete","static","haStyleDialog","css","_this$_params","deleteCard","LitElement"],"mappings":"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","file":"chunk.1bac0ba09edba17133f1.js","sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n  Fixes issue with not using shadow dom properly in iron-overlay-behavior/icon-focusables-helper.js\n*/\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\n\nimport { IronFocusablesHelper } from \"@polymer/iron-overlay-behavior/iron-focusables-helper.js\";\n\nexport const HaIronFocusablesHelper = {\n  /**\n   * Returns a sorted array of tabbable nodes, including the root node.\n   * It searches the tabbable nodes in the light and shadow dom of the chidren,\n   * sorting the result by tabindex.\n   * @param {!Node} node\n   * @return {!Array<!HTMLElement>}\n   */\n  getTabbableNodes: function(node) {\n    var result = [];\n    // If there is at least one element with tabindex > 0, we need to sort\n    // the final array by tabindex.\n    var needsSortByTabIndex = this._collectTabbableNodes(node, result);\n    if (needsSortByTabIndex) {\n      return IronFocusablesHelper._sortByTabIndex(result);\n    }\n    return result;\n  },\n\n  /**\n   * Searches for nodes that are tabbable and adds them to the `result` array.\n   * Returns if the `result` array needs to be sorted by tabindex.\n   * @param {!Node} node The starting point for the search; added to `result`\n   * if tabbable.\n   * @param {!Array<!HTMLElement>} result\n   * @return {boolean}\n   * @private\n   */\n  _collectTabbableNodes: function(node, result) {\n    // If not an element or not visible, no need to explore children.\n    if (\n      node.nodeType !== Node.ELEMENT_NODE ||\n      !IronFocusablesHelper._isVisible(node)\n    ) {\n      return false;\n    }\n    var element = /** @type {!HTMLElement} */ (node);\n    var tabIndex = IronFocusablesHelper._normalizedTabIndex(element);\n    var needsSort = tabIndex > 0;\n    if (tabIndex >= 0) {\n      result.push(element);\n    }\n\n    // In ShadowDOM v1, tab order is affected by the order of distrubution.\n    // E.g. getTabbableNodes(#root) in ShadowDOM v1 should return [#A, #B];\n    // in ShadowDOM v0 tab order is not affected by the distrubution order,\n    // in fact getTabbableNodes(#root) returns [#B, #A].\n    //  <div id=\"root\">\n    //   <!-- shadow -->\n    //     <slot name=\"a\">\n    //     <slot name=\"b\">\n    //   <!-- /shadow -->\n    //   <input id=\"A\" slot=\"a\">\n    //   <input id=\"B\" slot=\"b\" tabindex=\"1\">\n    //  </div>\n    // TODO(valdrin) support ShadowDOM v1 when upgrading to Polymer v2.0.\n    var children;\n    if (element.localName === \"content\" || element.localName === \"slot\") {\n      children = dom(element).getDistributedNodes();\n    } else {\n      // /////////////////////////\n      // Use shadow root if possible, will check for distributed nodes.\n      // THIS IS THE CHANGED LINE\n      children = dom(element.shadowRoot || element.root || element).children;\n      // /////////////////////////\n    }\n    for (var i = 0; i < children.length; i++) {\n      // Ensure method is always invoked to collect tabbable children.\n      needsSort = this._collectTabbableNodes(children[i], result) || needsSort;\n    }\n    return needsSort;\n  },\n};\n","import \"@polymer/paper-dialog/paper-dialog\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\nimport { HaIronFocusablesHelper } from \"./ha-iron-focusables-helper.js\";\n// tslint:disable-next-line\nimport { PaperDialogElement } from \"@polymer/paper-dialog/paper-dialog\";\n\nconst paperDialogClass = customElements.get(\"paper-dialog\");\n\n// behavior that will override existing iron-overlay-behavior and call the fixed implementation\nconst haTabFixBehaviorImpl = {\n  get _focusableNodes() {\n    return HaIronFocusablesHelper.getTabbableNodes(this);\n  },\n};\n\n// paper-dialog that uses the haTabFixBehaviorImpl behvaior\n// export class HaPaperDialog extends paperDialogClass {}\n// @ts-ignore\nexport class HaPaperDialog\n  extends mixinBehaviors([haTabFixBehaviorImpl], paperDialogClass)\n  implements PaperDialogElement {}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dialog\": HaPaperDialog;\n  }\n}\ncustomElements.define(\"ha-paper-dialog\", HaPaperDialog);\n","import \"@polymer/paper-input/paper-textarea\";\n\nimport { createCardElement } from \"../../create-element/create-card-element\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCardConfig } from \"../../../../data/lovelace\";\nimport { LovelaceCard } from \"../../types\";\nimport { ConfigError } from \"../types\";\nimport { createErrorCardConfig } from \"../../cards/hui-error-card\";\nimport { computeRTL } from \"../../../../common/util/compute_rtl\";\n\nexport class HuiCardPreview extends HTMLElement {\n  private _hass?: HomeAssistant;\n  private _element?: LovelaceCard;\n  private _config?: LovelaceCardConfig;\n\n  private get _error() {\n    return this._element?.tagName === \"HUI-ERROR-CARD\";\n  }\n\n  constructor() {\n    super();\n    this.addEventListener(\"ll-rebuild\", () => {\n      this._cleanup();\n      if (this._config) {\n        this.config = this._config;\n      }\n    });\n  }\n\n  set hass(hass: HomeAssistant) {\n    if (!this._hass || this._hass.language !== hass.language) {\n      this.style.direction = computeRTL(hass) ? \"rtl\" : \"ltr\";\n    }\n\n    this._hass = hass;\n    if (this._element) {\n      this._element.hass = hass;\n    }\n  }\n\n  set error(error: ConfigError) {\n    this._createCard(\n      createErrorCardConfig(`${error.type}: ${error.message}`, undefined)\n    );\n  }\n\n  set config(configValue: LovelaceCardConfig) {\n    const curConfig = this._config;\n    this._config = configValue;\n\n    if (!configValue) {\n      this._cleanup();\n      return;\n    }\n\n    if (!configValue.type) {\n      this._createCard(\n        createErrorCardConfig(\"No card type found\", configValue)\n      );\n      return;\n    }\n\n    if (!this._element) {\n      this._createCard(configValue);\n      return;\n    }\n\n    // in case the element was an error element we always want to recreate it\n    if (!this._error && curConfig && configValue.type === curConfig.type) {\n      try {\n        this._element.setConfig(configValue);\n      } catch (err) {\n        this._createCard(createErrorCardConfig(err.message, configValue));\n      }\n    } else {\n      this._createCard(configValue);\n    }\n  }\n\n  private _createCard(configValue: LovelaceCardConfig): void {\n    this._cleanup();\n    this._element = createCardElement(configValue);\n\n    if (this._hass) {\n      this._element!.hass = this._hass;\n    }\n\n    this.appendChild(this._element!);\n  }\n\n  private _cleanup() {\n    if (!this._element) {\n      return;\n    }\n    this.removeChild(this._element);\n    this._element = undefined;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-card-preview\": HuiCardPreview;\n  }\n}\n\ncustomElements.define(\"hui-card-preview\", HuiCardPreview);\n","import {\n  css,\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResultArray,\n  customElement,\n  property,\n  query,\n} from \"lit-element\";\n\nimport \"./hui-card-preview\";\nimport \"../../../../components/dialog/ha-paper-dialog\";\n\nimport deepFreeze from \"deep-freeze\";\n\n// tslint:disable-next-line: no-duplicate-imports\nimport { HaPaperDialog } from \"../../../../components/dialog/ha-paper-dialog\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCardConfig } from \"../../../../data/lovelace\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport { DeleteCardDialogParams } from \"./show-delete-card-dialog\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\n\n@customElement(\"hui-dialog-delete-card\")\nexport class HuiDialogDeleteCard extends LitElement {\n  @property() protected hass!: HomeAssistant;\n  @property() private _params?: DeleteCardDialogParams;\n  @property() private _cardConfig?: LovelaceCardConfig;\n  @query(\"ha-paper-dialog\") private _dialog!: HaPaperDialog;\n\n  public async showDialog(params: DeleteCardDialogParams): Promise<void> {\n    this._params = params;\n    this._cardConfig = params.cardConfig;\n    if (!Object.isFrozen(this._cardConfig)) {\n      this._cardConfig = deepFreeze(this._cardConfig);\n    }\n    await this.updateComplete;\n    fireEvent(this._dialog as HTMLElement, \"iron-resize\");\n  }\n\n  protected render(): TemplateResult {\n    if (!this._params) {\n      return html``;\n    }\n\n    return html`\n      <ha-paper-dialog with-backdrop opened>\n        <h2>\n          ${this.hass.localize(\"ui.panel.lovelace.cards.confirm_delete\")}\n        </h2>\n        <paper-dialog-scrollable>\n          ${this._cardConfig\n            ? html`\n                <div class=\"element-preview\">\n                  <hui-card-preview\n                    .hass=${this.hass}\n                    .config=\"${this._cardConfig}\"\n                  ></hui-card-preview>\n                </div>\n              `\n            : \"\"}\n        </paper-dialog-scrollable>\n        <div class=\"paper-dialog-buttons\">\n          <mwc-button @click=\"${this._close}\">\n            ${this.hass!.localize(\"ui.common.cancel\")}\n          </mwc-button>\n          <mwc-button class=\"warning\" @click=\"${this._delete}\">\n            ${this.hass!.localize(\"ui.common.delete\")}\n          </mwc-button>\n        </div>\n      </ha-paper-dialog>\n    `;\n  }\n\n  static get styles(): CSSResultArray {\n    return [\n      haStyleDialog,\n      css`\n        .element-preview {\n          position: relative;\n        }\n        hui-card-preview {\n          margin: 4px auto;\n          max-width: 500px;\n          display: block;\n          width: 100%;\n        }\n      `,\n    ];\n  }\n\n  private _close(): void {\n    this._params = undefined;\n    this._cardConfig = undefined;\n  }\n\n  private _delete(): void {\n    if (!this._params?.deleteCard) {\n      return;\n    }\n    this._params.deleteCard();\n    this._close();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-dialog-delete-card\": HuiDialogDeleteCard;\n  }\n}\n"],"sourceRoot":""}