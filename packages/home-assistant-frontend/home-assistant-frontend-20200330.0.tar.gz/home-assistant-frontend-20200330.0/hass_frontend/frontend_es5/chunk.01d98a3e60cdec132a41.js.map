{"version":3,"sources":["webpack:///./src/components/dialog/ha-iron-focusables-helper.js","webpack:///./src/components/dialog/ha-paper-dialog.ts","webpack:///./src/panels/lovelace/editor/card-editor/hui-card-preview.ts","webpack:///./src/panels/lovelace/editor/card-editor/hui-dialog-delete-card.ts"],"names":["HaIronFocusablesHelper","getTabbableNodes","node","result","this","_collectTabbableNodes","IronFocusablesHelper","_sortByTabIndex","nodeType","Node","ELEMENT_NODE","_isVisible","children","element","tabIndex","_normalizedTabIndex","needsSort","push","localName","dom","getDistributedNodes","shadowRoot","root","i","length","paperDialogClass","customElements","get","haTabFixBehaviorImpl","_focusableNodes","HaPaperDialog","_mixinBehaviors","_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","apply","arguments","_inherits","mixinBehaviors","define","HuiCardPreview","_HTMLElement","_this","call","_defineProperty","_assertThisInitialized","addEventListener","_cleanup","_config","config","_wrapNativeSuper","HTMLElement","_createClass","key","_this$_element","_element","tagName","value","configValue","createCardElement","_hass","hass","appendChild","removeChild","undefined","set","language","style","direction","computeRTL","error","_createCard","createErrorCardConfig","concat","type","message","curConfig","_error","setConfig","err","HuiDialogDeleteCard","_decorate","customElement","_initialize","_LitElement","F","_LitElement2","_getPrototypeOf2","_len","args","Array","_key","d","kind","decorators","property","query","_showDialog","regeneratorRuntime","mark","_callee","params","wrap","_context","prev","next","_params","_cardConfig","cardConfig","Object","isFrozen","deepFreeze","updateComplete","fireEvent","_dialog","stop","_x","html","_templateObject2","localize","_templateObject3","_close","_delete","_templateObject","static","haStyleDialog","css","_templateObject4","_this$_params","deleteCard","LitElement"],"mappings":"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","file":"chunk.01d98a3e60cdec132a41.js","sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at\nhttp://polymer.github.io/LICENSE.txt The complete set of authors may be found at\nhttp://polymer.github.io/AUTHORS.txt The complete set of contributors may be\nfound at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as\npart of the polymer project is also subject to an additional IP rights grant\nfound at http://polymer.github.io/PATENTS.txt\n*/\n/*\n  Fixes issue with not using shadow dom properly in iron-overlay-behavior/icon-focusables-helper.js\n*/\nimport { dom } from \"@polymer/polymer/lib/legacy/polymer.dom.js\";\n\nimport { IronFocusablesHelper } from \"@polymer/iron-overlay-behavior/iron-focusables-helper.js\";\n\nexport const HaIronFocusablesHelper = {\n  /**\n   * Returns a sorted array of tabbable nodes, including the root node.\n   * It searches the tabbable nodes in the light and shadow dom of the chidren,\n   * sorting the result by tabindex.\n   * @param {!Node} node\n   * @return {!Array<!HTMLElement>}\n   */\n  getTabbableNodes: function(node) {\n    var result = [];\n    // If there is at least one element with tabindex > 0, we need to sort\n    // the final array by tabindex.\n    var needsSortByTabIndex = this._collectTabbableNodes(node, result);\n    if (needsSortByTabIndex) {\n      return IronFocusablesHelper._sortByTabIndex(result);\n    }\n    return result;\n  },\n\n  /**\n   * Searches for nodes that are tabbable and adds them to the `result` array.\n   * Returns if the `result` array needs to be sorted by tabindex.\n   * @param {!Node} node The starting point for the search; added to `result`\n   * if tabbable.\n   * @param {!Array<!HTMLElement>} result\n   * @return {boolean}\n   * @private\n   */\n  _collectTabbableNodes: function(node, result) {\n    // If not an element or not visible, no need to explore children.\n    if (\n      node.nodeType !== Node.ELEMENT_NODE ||\n      !IronFocusablesHelper._isVisible(node)\n    ) {\n      return false;\n    }\n    var element = /** @type {!HTMLElement} */ (node);\n    var tabIndex = IronFocusablesHelper._normalizedTabIndex(element);\n    var needsSort = tabIndex > 0;\n    if (tabIndex >= 0) {\n      result.push(element);\n    }\n\n    // In ShadowDOM v1, tab order is affected by the order of distrubution.\n    // E.g. getTabbableNodes(#root) in ShadowDOM v1 should return [#A, #B];\n    // in ShadowDOM v0 tab order is not affected by the distrubution order,\n    // in fact getTabbableNodes(#root) returns [#B, #A].\n    //  <div id=\"root\">\n    //   <!-- shadow -->\n    //     <slot name=\"a\">\n    //     <slot name=\"b\">\n    //   <!-- /shadow -->\n    //   <input id=\"A\" slot=\"a\">\n    //   <input id=\"B\" slot=\"b\" tabindex=\"1\">\n    //  </div>\n    // TODO(valdrin) support ShadowDOM v1 when upgrading to Polymer v2.0.\n    var children;\n    if (element.localName === \"content\" || element.localName === \"slot\") {\n      children = dom(element).getDistributedNodes();\n    } else {\n      // /////////////////////////\n      // Use shadow root if possible, will check for distributed nodes.\n      // THIS IS THE CHANGED LINE\n      children = dom(element.shadowRoot || element.root || element).children;\n      // /////////////////////////\n    }\n    for (var i = 0; i < children.length; i++) {\n      // Ensure method is always invoked to collect tabbable children.\n      needsSort = this._collectTabbableNodes(children[i], result) || needsSort;\n    }\n    return needsSort;\n  },\n};\n","import \"@polymer/paper-dialog/paper-dialog\";\nimport { mixinBehaviors } from \"@polymer/polymer/lib/legacy/class\";\nimport { HaIronFocusablesHelper } from \"./ha-iron-focusables-helper.js\";\n// tslint:disable-next-line\nimport { PaperDialogElement } from \"@polymer/paper-dialog/paper-dialog\";\n\nconst paperDialogClass = customElements.get(\"paper-dialog\");\n\n// behavior that will override existing iron-overlay-behavior and call the fixed implementation\nconst haTabFixBehaviorImpl = {\n  get _focusableNodes() {\n    return HaIronFocusablesHelper.getTabbableNodes(this);\n  },\n};\n\n// paper-dialog that uses the haTabFixBehaviorImpl behvaior\n// export class HaPaperDialog extends paperDialogClass {}\n// @ts-ignore\nexport class HaPaperDialog\n  extends mixinBehaviors([haTabFixBehaviorImpl], paperDialogClass)\n  implements PaperDialogElement {}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-paper-dialog\": HaPaperDialog;\n  }\n}\ncustomElements.define(\"ha-paper-dialog\", HaPaperDialog);\n","import \"@polymer/paper-input/paper-textarea\";\n\nimport { createCardElement } from \"../../create-element/create-card-element\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCardConfig } from \"../../../../data/lovelace\";\nimport { LovelaceCard } from \"../../types\";\nimport { ConfigError } from \"../types\";\nimport { createErrorCardConfig } from \"../../cards/hui-error-card\";\nimport { computeRTL } from \"../../../../common/util/compute_rtl\";\n\nexport class HuiCardPreview extends HTMLElement {\n  private _hass?: HomeAssistant;\n  private _element?: LovelaceCard;\n  private _config?: LovelaceCardConfig;\n\n  private get _error() {\n    return this._element?.tagName === \"HUI-ERROR-CARD\";\n  }\n\n  constructor() {\n    super();\n    this.addEventListener(\"ll-rebuild\", () => {\n      this._cleanup();\n      if (this._config) {\n        this.config = this._config;\n      }\n    });\n  }\n\n  set hass(hass: HomeAssistant) {\n    if (!this._hass || this._hass.language !== hass.language) {\n      this.style.direction = computeRTL(hass) ? \"rtl\" : \"ltr\";\n    }\n\n    this._hass = hass;\n    if (this._element) {\n      this._element.hass = hass;\n    }\n  }\n\n  set error(error: ConfigError) {\n    this._createCard(\n      createErrorCardConfig(`${error.type}: ${error.message}`, undefined)\n    );\n  }\n\n  set config(configValue: LovelaceCardConfig) {\n    const curConfig = this._config;\n    this._config = configValue;\n\n    if (!configValue) {\n      this._cleanup();\n      return;\n    }\n\n    if (!configValue.type) {\n      this._createCard(\n        createErrorCardConfig(\"No card type found\", configValue)\n      );\n      return;\n    }\n\n    if (!this._element) {\n      this._createCard(configValue);\n      return;\n    }\n\n    // in case the element was an error element we always want to recreate it\n    if (!this._error && curConfig && configValue.type === curConfig.type) {\n      try {\n        this._element.setConfig(configValue);\n      } catch (err) {\n        this._createCard(createErrorCardConfig(err.message, configValue));\n      }\n    } else {\n      this._createCard(configValue);\n    }\n  }\n\n  private _createCard(configValue: LovelaceCardConfig): void {\n    this._cleanup();\n    this._element = createCardElement(configValue);\n\n    if (this._hass) {\n      this._element!.hass = this._hass;\n    }\n\n    this.appendChild(this._element!);\n  }\n\n  private _cleanup() {\n    if (!this._element) {\n      return;\n    }\n    this.removeChild(this._element);\n    this._element = undefined;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-card-preview\": HuiCardPreview;\n  }\n}\n\ncustomElements.define(\"hui-card-preview\", HuiCardPreview);\n","import {\n  css,\n  html,\n  LitElement,\n  TemplateResult,\n  CSSResultArray,\n  customElement,\n  property,\n  query,\n} from \"lit-element\";\n\nimport \"./hui-card-preview\";\nimport \"../../../../components/dialog/ha-paper-dialog\";\n\nimport deepFreeze from \"deep-freeze\";\n\n// tslint:disable-next-line: no-duplicate-imports\nimport { HaPaperDialog } from \"../../../../components/dialog/ha-paper-dialog\";\nimport { HomeAssistant } from \"../../../../types\";\nimport { LovelaceCardConfig } from \"../../../../data/lovelace\";\nimport { haStyleDialog } from \"../../../../resources/styles\";\nimport { DeleteCardDialogParams } from \"./show-delete-card-dialog\";\nimport { fireEvent } from \"../../../../common/dom/fire_event\";\n\n@customElement(\"hui-dialog-delete-card\")\nexport class HuiDialogDeleteCard extends LitElement {\n  @property() protected hass!: HomeAssistant;\n  @property() private _params?: DeleteCardDialogParams;\n  @property() private _cardConfig?: LovelaceCardConfig;\n  @query(\"ha-paper-dialog\") private _dialog!: HaPaperDialog;\n\n  public async showDialog(params: DeleteCardDialogParams): Promise<void> {\n    this._params = params;\n    this._cardConfig = params.cardConfig;\n    if (!Object.isFrozen(this._cardConfig)) {\n      this._cardConfig = deepFreeze(this._cardConfig);\n    }\n    await this.updateComplete;\n    fireEvent(this._dialog as HTMLElement, \"iron-resize\");\n  }\n\n  protected render(): TemplateResult {\n    if (!this._params) {\n      return html``;\n    }\n\n    return html`\n      <ha-paper-dialog with-backdrop opened>\n        <h2>\n          ${this.hass.localize(\"ui.panel.lovelace.cards.confirm_delete\")}\n        </h2>\n        <paper-dialog-scrollable>\n          ${this._cardConfig\n            ? html`\n                <div class=\"element-preview\">\n                  <hui-card-preview\n                    .hass=${this.hass}\n                    .config=\"${this._cardConfig}\"\n                  ></hui-card-preview>\n                </div>\n              `\n            : \"\"}\n        </paper-dialog-scrollable>\n        <div class=\"paper-dialog-buttons\">\n          <mwc-button @click=\"${this._close}\">\n            ${this.hass!.localize(\"ui.common.cancel\")}\n          </mwc-button>\n          <mwc-button class=\"warning\" @click=\"${this._delete}\">\n            ${this.hass!.localize(\"ui.common.delete\")}\n          </mwc-button>\n        </div>\n      </ha-paper-dialog>\n    `;\n  }\n\n  static get styles(): CSSResultArray {\n    return [\n      haStyleDialog,\n      css`\n        .element-preview {\n          position: relative;\n        }\n        hui-card-preview {\n          margin: 4px auto;\n          max-width: 500px;\n          display: block;\n          width: 100%;\n        }\n      `,\n    ];\n  }\n\n  private _close(): void {\n    this._params = undefined;\n    this._cardConfig = undefined;\n  }\n\n  private _delete(): void {\n    if (!this._params?.deleteCard) {\n      return;\n    }\n    this._params.deleteCard();\n    this._close();\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"hui-dialog-delete-card\": HuiDialogDeleteCard;\n  }\n}\n"],"sourceRoot":""}