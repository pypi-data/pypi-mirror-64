"""
Autogenerated ODE definition from SBML file with sbmlutils.

    model: limax_53
"""
import numpy as np
import pandas as pd


# -------------------
# ids
# -------------------
xids = ["Aar_apap", "Aar_co2c13", "Aar_metc13", "Abreath_co2c13", "Agu_apap", "Agu_blood_apap", "Agu_blood_co2c13", "Agu_blood_metc13", "Agu_co2c13", "Agu_metc13", "Ahe_apap", "Ahe_blood_apap", "Ahe_blood_co2c13", "Ahe_blood_metc13", "Ahe_co2c13", "Ahe_metc13", "Aki_apap", "Aki_blood_apap", "Aki_blood_co2c13", "Aki_blood_metc13", "Aki_co2c13", "Aki_metc13", "Ali_apap", "Ali_blood_apap", "Ali_blood_co2c13", "Ali_blood_metc13", "Ali_co2c13", "Ali_metc13", "Alu_apap", "Alu_blood_apap", "Alu_blood_co2c13", "Alu_blood_metc13", "Alu_co2c13", "Alu_metc13", "Are_apap", "Are_blood_apap", "Are_blood_co2c13", "Are_blood_metc13", "Are_co2c13", "Are_metc13", "Asp_apap", "Asp_blood_apap", "Asp_blood_co2c13", "Asp_blood_metc13", "Asp_co2c13", "Asp_metc13", "Aurine_apap", "Aurine_co2c13", "Aurine_metc13", "Ave_apap", "Ave_co2c13", "Ave_metc13", "IVDOSE_apap", "IVDOSE_co2c13", "IVDOSE_metc13", "PODOSE_apap", "PODOSE_co2c13", "PODOSE_metc13", "cum_dose_apap", "cum_dose_co2c13", "cum_dose_metc13", ]
pids = ["APAPD_CL", "APAPD_Km_apap", "BP_apap", "BP_co2c13", "BP_metc13", "BW", "CLrenal_apap", "CLrenal_co2c13", "CLrenal_metc13", "COBW", "COHRI", "CYP1A2MET_CL", "CYP1A2MET_Km_met", "EXHCO2_CL", "EXHCO2_Km_co2", "FQgu", "FQh", "FQhe", "FQki", "FQlu", "FQsp", "FVar", "FVgu", "FVhe", "FVki", "FVli", "FVlu", "FVsp", "FVve", "F_PAR", "F_apap", "F_co2c13", "F_metc13", "Fblood", "HEIGHT", "HR", "HRrest", "Ka_apap", "Ka_co2c13", "Ka_metc13", "Kp_apap", "Kp_co2c13", "Kp_metc13", "MPPGL", "Mr_apap", "Mr_co2c13", "Mr_metc13", "P_CO2BSA", "R_PDB", "Ri_apap", "Ri_co2c13", "Ri_metc13", "Vbreath", "Vp_apap", "Vp_co2c13", "Vp_metc13", "Vurine", "ti_apap", "ti_co2c13", "ti_metc13", ]
yids = ["Absorption_apap", "Absorption_co2c13", "Absorption_metc13", "BSA", "CO", "FQre", "FVre", "Infusion_apap", "Infusion_co2c13", "Infusion_metc13", "Ki_apap", "Ki_co2c13", "Ki_metc13", "Var", "Vgu", "Vhe", "Vki", "Vli", "Vlu", "Vsp", "Vve", "Xbreath_co2c13", "Xurine_apap", "Xurine_co2c13", "Xurine_metc13", "APAPD_CLliv", "CYP1A2MET_CLliv", "Car_apap", "Car_co2c13", "Car_metc13", "Cve_apap", "Cve_co2c13", "Cve_metc13", "Injection_apap", "Injection_co2c13", "Injection_metc13", "P_CO2", "QC", "Vgu_blood", "Vgu_tissue", "Vhe_blood", "Vhe_tissue", "Vki_blood", "Vki_tissue", "Vli_blood", "Vli_tissue", "Vlu_blood", "Vlu_tissue", "Vre", "Vsp_blood", "Vsp_tissue", "Cgu_apap", "Cgu_blood_apap", "Cgu_blood_co2c13", "Cgu_blood_metc13", "Cgu_co2c13", "Cgu_metc13", "Che_apap", "Che_blood_apap", "Che_blood_co2c13", "Che_blood_metc13", "Che_co2c13", "Che_metc13", "Cki_apap", "Cki_blood_apap", "Cki_blood_co2c13", "Cki_blood_metc13", "Cki_co2c13", "Cki_metc13", "Cli_apap", "Cli_blood_apap", "Cli_blood_co2c13", "Cli_blood_metc13", "Cli_co2c13", "Cli_metc13", "Clu_apap", "Clu_blood_apap", "Clu_blood_co2c13", "Clu_blood_metc13", "Clu_co2c13", "Clu_metc13", "Cpl_ve_apap", "Cpl_ve_co2c13", "Cpl_ve_metc13", "Csp_apap", "Csp_blood_apap", "Csp_blood_co2c13", "Csp_blood_metc13", "Csp_co2c13", "Csp_metc13", "Mar_apap", "Mar_co2c13", "Mar_metc13", "Mve_apap", "Mve_co2c13", "Mve_metc13", "P_CO2c12", "Qgu", "Qh", "Qhe", "Qki", "Qlu", "Qre", "Qsp", "Vre_blood", "Vre_tissue", "APAPD", "CYP1A2MET", "Cre_apap", "Cre_blood_apap", "Cre_blood_co2c13", "Cre_blood_metc13", "Cre_co2c13", "Cre_metc13", "Exhalation_co2c13", "Flow_ar_gu_apap", "Flow_ar_gu_co2c13", "Flow_ar_gu_metc13", "Flow_ar_he_apap", "Flow_ar_he_co2c13", "Flow_ar_he_metc13", "Flow_ar_ki_apap", "Flow_ar_ki_co2c13", "Flow_ar_ki_metc13", "Flow_ar_re_apap", "Flow_ar_re_co2c13", "Flow_ar_re_metc13", "Flow_ar_sp_apap", "Flow_ar_sp_co2c13", "Flow_ar_sp_metc13", "Flow_gu_li_apap", "Flow_gu_li_co2c13", "Flow_gu_li_metc13", "Flow_he_ve_apap", "Flow_he_ve_co2c13", "Flow_he_ve_metc13", "Flow_ki_ve_apap", "Flow_ki_ve_co2c13", "Flow_ki_ve_metc13", "Flow_li_ve_apap", "Flow_li_ve_co2c13", "Flow_li_ve_metc13", "Flow_lu_ar_apap", "Flow_lu_ar_co2c13", "Flow_lu_ar_metc13", "Flow_sp_li_apap", "Flow_sp_li_co2c13", "Flow_sp_li_metc13", "Flow_ve_lu_apap", "Flow_ve_lu_co2c13", "Flow_ve_lu_metc13", "Qha", "RenalClearance_apap", "RenalClearance_co2c13", "RenalClearance_metc13", "import_gu_apap", "import_gu_co2c13", "import_gu_metc13", "import_he_apap", "import_he_co2c13", "import_he_metc13", "import_ki_apap", "import_ki_co2c13", "import_ki_metc13", "import_li_apap", "import_li_co2c13", "import_li_metc13", "import_lu_apap", "import_lu_co2c13", "import_lu_metc13", "import_sp_apap", "import_sp_co2c13", "import_sp_metc13", "Flow_ar_li_apap", "Flow_ar_li_co2c13", "Flow_ar_li_metc13", "Flow_re_ve_apap", "Flow_re_ve_co2c13", "Flow_re_ve_metc13", "P_CO2c13", "import_re_apap", "import_re_co2c13", "import_re_metc13", "DOB", "P_CO2Fc13", "P_CO2R", ]

# -------------------
# initial conditions
# -------------------
x0 = np.array([
    0.0,     # [0] Aar_apap
    0.0,     # [1] Aar_co2c13
    0.0,     # [2] Aar_metc13
    0.0,     # [3] Abreath_co2c13
    0.0,     # [4] Agu_apap
    0.0,     # [5] Agu_blood_apap
    0.0,     # [6] Agu_blood_co2c13
    0.0,     # [7] Agu_blood_metc13
    0.0,     # [8] Agu_co2c13
    0.0,     # [9] Agu_metc13
    0.0,     # [10] Ahe_apap
    0.0,     # [11] Ahe_blood_apap
    0.0,     # [12] Ahe_blood_co2c13
    0.0,     # [13] Ahe_blood_metc13
    0.0,     # [14] Ahe_co2c13
    0.0,     # [15] Ahe_metc13
    0.0,     # [16] Aki_apap
    0.0,     # [17] Aki_blood_apap
    0.0,     # [18] Aki_blood_co2c13
    0.0,     # [19] Aki_blood_metc13
    0.0,     # [20] Aki_co2c13
    0.0,     # [21] Aki_metc13
    0.0,     # [22] Ali_apap
    0.0,     # [23] Ali_blood_apap
    0.0,     # [24] Ali_blood_co2c13
    0.0,     # [25] Ali_blood_metc13
    0.0,     # [26] Ali_co2c13
    0.0,     # [27] Ali_metc13
    0.0,     # [28] Alu_apap
    0.0,     # [29] Alu_blood_apap
    0.0,     # [30] Alu_blood_co2c13
    0.0,     # [31] Alu_blood_metc13
    0.0,     # [32] Alu_co2c13
    0.0,     # [33] Alu_metc13
    0.0,     # [34] Are_apap
    0.0,     # [35] Are_blood_apap
    0.0,     # [36] Are_blood_co2c13
    0.0,     # [37] Are_blood_metc13
    0.0,     # [38] Are_co2c13
    0.0,     # [39] Are_metc13
    0.0,     # [40] Asp_apap
    0.0,     # [41] Asp_blood_apap
    0.0,     # [42] Asp_blood_co2c13
    0.0,     # [43] Asp_blood_metc13
    0.0,     # [44] Asp_co2c13
    0.0,     # [45] Asp_metc13
    0.0,     # [46] Aurine_apap
    0.0,     # [47] Aurine_co2c13
    0.0,     # [48] Aurine_metc13
    0.0,     # [49] Ave_apap
    0.0,     # [50] Ave_co2c13
    0.0,     # [51] Ave_metc13
    0.0,     # [52] IVDOSE_apap
    0.0,     # [53] IVDOSE_co2c13
    0.0,     # [54] IVDOSE_metc13
    0.0,     # [55] PODOSE_apap
    0.0,     # [56] PODOSE_co2c13
    0.0,     # [57] PODOSE_metc13
    0.0,     # [58] cum_dose_apap
    0.0,     # [59] cum_dose_co2c13
    0.0,     # [60] cum_dose_metc13
])

# -------------------
# parameters
# -------------------
p = np.array([
    2.21,     # [0] APAPD_CL
    0.35,     # [1] APAPD_Km_apap
    1.0,     # [2] BP_apap
    1.0,     # [3] BP_co2c13
    1.0,     # [4] BP_metc13
    75.0,     # [5] BW
    0.714,     # [6] CLrenal_apap
    0.0,     # [7] CLrenal_co2c13
    0.0,     # [8] CLrenal_metc13
    1.548,     # [9] COBW
    150.0,     # [10] COHRI
    1.5,     # [11] CYP1A2MET_CL
    0.02,     # [12] CYP1A2MET_Km_met
    10.0,     # [13] EXHCO2_CL
    0.5,     # [14] EXHCO2_Km_co2
    0.146,     # [15] FQgu
    0.215,     # [16] FQh
    0.04,     # [17] FQhe
    0.19,     # [18] FQki
    1.0,     # [19] FQlu
    0.017,     # [20] FQsp
    0.0257,     # [21] FVar
    0.0171,     # [22] FVgu
    0.0047,     # [23] FVhe
    0.0044,     # [24] FVki
    0.021,     # [25] FVli
    0.0076,     # [26] FVlu
    0.0026,     # [27] FVsp
    0.0514,     # [28] FVve
    0.85,     # [29] F_PAR
    0.87,     # [30] F_apap
    1.0,     # [31] F_co2c13
    1.0,     # [32] F_metc13
    0.02,     # [33] Fblood
    170.0,     # [34] HEIGHT
    70.0,     # [35] HR
    70.0,     # [36] HRrest
    2.47,     # [37] Ka_apap
    5.87,     # [38] Ka_co2c13
    0.0061,     # [39] Ka_metc13
    1.0,     # [40] Kp_apap
    1.0,     # [41] Kp_co2c13
    1.0,     # [42] Kp_metc13
    45.0,     # [43] MPPGL
    151.16,     # [44] Mr_apap
    62.02,     # [45] Mr_co2c13
    165.19,     # [46] Mr_metc13
    300.0,     # [47] P_CO2BSA
    0.01123,     # [48] R_PDB
    0.0,     # [49] Ri_apap
    0.0,     # [50] Ri_co2c13
    0.0,     # [51] Ri_metc13
    1.0,     # [52] Vbreath
    1.0,     # [53] Vp_apap
    1.0,     # [54] Vp_co2c13
    1.0,     # [55] Vp_metc13
    1.0,     # [56] Vurine
    10.0,     # [57] ti_apap
    10.0,     # [58] ti_co2c13
    10.0,     # [59] ti_metc13
])


def f_dxdt(x, t, p):
    """ ODE system """
    Absorption_apap = (p[37] * x[55] / p[44]) * p[30]      # [0] Absorption_apap
    Absorption_co2c13 = (p[38] * x[56] / p[45]) * p[31]      # [1] Absorption_co2c13
    Absorption_metc13 = (p[39] * x[57] / p[46]) * p[32]      # [2] Absorption_metc13
    BSA = 0.024265 * (p[5] / 1)**0.5378 * (p[34] / 1)**0.3964      # [3] BSA
    CO = p[5] * p[9] + (p[35] - p[36]) * p[10] / 60      # [4] CO
    FQre = 1 - (p[17] + p[15] + p[18] + p[16] + p[20])      # [5] FQre
    FVre = 1 - (p[23] + p[22] + p[24] + p[25] + p[26] + p[27] + p[28] + p[21])      # [6] FVre
    Infusion_apap = (p[49] / p[44]) * 60      # [7] Infusion_apap
    Infusion_co2c13 = (p[50] / p[45]) * 60      # [8] Infusion_co2c13
    Infusion_metc13 = (p[51] / p[46]) * 60      # [9] Infusion_metc13
    Ki_apap = (1.386 / p[57]) * 3600      # [10] Ki_apap
    Ki_co2c13 = (1.386 / p[58]) * 3600      # [11] Ki_co2c13
    Ki_metc13 = (1.386 / p[59]) * 3600      # [12] Ki_metc13
    Var = p[5] * p[21] - (p[21] / (p[21] + p[28])) * p[5] * p[33] * (1 - p[28] - p[21])      # [13] Var
    Vgu = p[5] * p[22]      # [14] Vgu
    Vhe = p[5] * p[23]      # [15] Vhe
    Vki = p[5] * p[24]      # [16] Vki
    Vli = p[5] * p[25]      # [17] Vli
    Vlu = p[5] * p[26]      # [18] Vlu
    Vsp = p[5] * p[27]      # [19] Vsp
    Vve = p[5] * p[28] - (p[28] / (p[21] + p[28])) * p[5] * p[33] * (1 - p[28] - p[21])      # [20] Vve
    Xbreath_co2c13 = x[3] * p[45]      # [21] Xbreath_co2c13
    Xurine_apap = x[46] * p[44]      # [22] Xurine_apap
    Xurine_co2c13 = x[47] * p[45]      # [23] Xurine_co2c13
    Xurine_metc13 = x[48] * p[46]      # [24] Xurine_metc13
    APAPD_CLliv = p[0] * p[43] * Vli * p[29] * 60 / 1000      # [25] APAPD_CLliv
    CYP1A2MET_CLliv = p[11] * p[43] * Vli * p[29] * 60 / 1000      # [26] CYP1A2MET_CLliv
    Car_apap = x[0] / Var      # [27] Car_apap
    Car_co2c13 = x[1] / Var      # [28] Car_co2c13
    Car_metc13 = x[2] / Var      # [29] Car_metc13
    Cve_apap = x[49] / Vve      # [30] Cve_apap
    Cve_co2c13 = x[50] / Vve      # [31] Cve_co2c13
    Cve_metc13 = x[51] / Vve      # [32] Cve_metc13
    Injection_apap = Ki_apap * x[52] / p[44]      # [33] Injection_apap
    Injection_co2c13 = Ki_co2c13 * x[53] / p[45]      # [34] Injection_co2c13
    Injection_metc13 = Ki_metc13 * x[54] / p[46]      # [35] Injection_metc13
    P_CO2 = BSA * p[47] / 60      # [36] P_CO2
    QC = (CO / 1000) * 3600      # [37] QC
    Vgu_blood = Vgu * p[33]      # [38] Vgu_blood
    Vgu_tissue = Vgu * (1 - p[33])      # [39] Vgu_tissue
    Vhe_blood = Vhe * p[33]      # [40] Vhe_blood
    Vhe_tissue = Vhe * (1 - p[33])      # [41] Vhe_tissue
    Vki_blood = Vki * p[33]      # [42] Vki_blood
    Vki_tissue = Vki * (1 - p[33])      # [43] Vki_tissue
    Vli_blood = Vli * p[33]      # [44] Vli_blood
    Vli_tissue = Vli * (1 - p[33])      # [45] Vli_tissue
    Vlu_blood = Vlu * p[33]      # [46] Vlu_blood
    Vlu_tissue = Vlu * (1 - p[33])      # [47] Vlu_tissue
    Vre = p[5] * FVre      # [48] Vre
    Vsp_blood = Vsp * p[33]      # [49] Vsp_blood
    Vsp_tissue = Vsp * (1 - p[33])      # [50] Vsp_tissue
    Cgu_apap = x[4] / Vgu_tissue      # [51] Cgu_apap
    Cgu_blood_apap = x[5] / Vgu_blood      # [52] Cgu_blood_apap
    Cgu_blood_co2c13 = x[6] / Vgu_blood      # [53] Cgu_blood_co2c13
    Cgu_blood_metc13 = x[7] / Vgu_blood      # [54] Cgu_blood_metc13
    Cgu_co2c13 = x[8] / Vgu_tissue      # [55] Cgu_co2c13
    Cgu_metc13 = x[9] / Vgu_tissue      # [56] Cgu_metc13
    Che_apap = x[10] / Vhe_tissue      # [57] Che_apap
    Che_blood_apap = x[11] / Vhe_blood      # [58] Che_blood_apap
    Che_blood_co2c13 = x[12] / Vhe_blood      # [59] Che_blood_co2c13
    Che_blood_metc13 = x[13] / Vhe_blood      # [60] Che_blood_metc13
    Che_co2c13 = x[14] / Vhe_tissue      # [61] Che_co2c13
    Che_metc13 = x[15] / Vhe_tissue      # [62] Che_metc13
    Cki_apap = x[16] / Vki_tissue      # [63] Cki_apap
    Cki_blood_apap = x[17] / Vki_blood      # [64] Cki_blood_apap
    Cki_blood_co2c13 = x[18] / Vki_blood      # [65] Cki_blood_co2c13
    Cki_blood_metc13 = x[19] / Vki_blood      # [66] Cki_blood_metc13
    Cki_co2c13 = x[20] / Vki_tissue      # [67] Cki_co2c13
    Cki_metc13 = x[21] / Vki_tissue      # [68] Cki_metc13
    Cli_apap = x[22] / Vli_tissue      # [69] Cli_apap
    Cli_blood_apap = x[23] / Vli_blood      # [70] Cli_blood_apap
    Cli_blood_co2c13 = x[24] / Vli_blood      # [71] Cli_blood_co2c13
    Cli_blood_metc13 = x[25] / Vli_blood      # [72] Cli_blood_metc13
    Cli_co2c13 = x[26] / Vli_tissue      # [73] Cli_co2c13
    Cli_metc13 = x[27] / Vli_tissue      # [74] Cli_metc13
    Clu_apap = x[28] / Vlu_tissue      # [75] Clu_apap
    Clu_blood_apap = x[29] / Vlu_blood      # [76] Clu_blood_apap
    Clu_blood_co2c13 = x[30] / Vlu_blood      # [77] Clu_blood_co2c13
    Clu_blood_metc13 = x[31] / Vlu_blood      # [78] Clu_blood_metc13
    Clu_co2c13 = x[32] / Vlu_tissue      # [79] Clu_co2c13
    Clu_metc13 = x[33] / Vlu_tissue      # [80] Clu_metc13
    Cpl_ve_apap = Cve_apap / p[2]      # [81] Cpl_ve_apap
    Cpl_ve_co2c13 = Cve_co2c13 / p[3]      # [82] Cpl_ve_co2c13
    Cpl_ve_metc13 = Cve_metc13 / p[4]      # [83] Cpl_ve_metc13
    Csp_apap = x[40] / Vsp_tissue      # [84] Csp_apap
    Csp_blood_apap = x[41] / Vsp_blood      # [85] Csp_blood_apap
    Csp_blood_co2c13 = x[42] / Vsp_blood      # [86] Csp_blood_co2c13
    Csp_blood_metc13 = x[43] / Vsp_blood      # [87] Csp_blood_metc13
    Csp_co2c13 = x[44] / Vsp_tissue      # [88] Csp_co2c13
    Csp_metc13 = x[45] / Vsp_tissue      # [89] Csp_metc13
    Mar_apap = Car_apap * p[44]      # [90] Mar_apap
    Mar_co2c13 = Car_co2c13 * p[45]      # [91] Mar_co2c13
    Mar_metc13 = Car_metc13 * p[46]      # [92] Mar_metc13
    Mve_apap = Cve_apap * p[44]      # [93] Mve_apap
    Mve_co2c13 = Cve_co2c13 * p[45]      # [94] Mve_co2c13
    Mve_metc13 = Cve_metc13 * p[46]      # [95] Mve_metc13
    P_CO2c12 = (1 / (1 + p[48])) * P_CO2      # [96] P_CO2c12
    Qgu = QC * p[15]      # [97] Qgu
    Qh = QC * p[16]      # [98] Qh
    Qhe = QC * p[17]      # [99] Qhe
    Qki = QC * p[18]      # [100] Qki
    Qlu = QC * p[19]      # [101] Qlu
    Qre = QC * FQre      # [102] Qre
    Qsp = QC * p[20]      # [103] Qsp
    Vre_blood = Vre * p[33]      # [104] Vre_blood
    Vre_tissue = Vre * (1 - p[33])      # [105] Vre_tissue
    APAPD = APAPD_CLliv * 1 * (Cli_apap / (Cli_apap + p[1]))      # [106] APAPD
    CYP1A2MET = CYP1A2MET_CLliv * 1 * (Cli_metc13 / (Cli_metc13 + p[12]))      # [107] CYP1A2MET
    Cre_apap = x[34] / Vre_tissue      # [108] Cre_apap
    Cre_blood_apap = x[35] / Vre_blood      # [109] Cre_blood_apap
    Cre_blood_co2c13 = x[36] / Vre_blood      # [110] Cre_blood_co2c13
    Cre_blood_metc13 = x[37] / Vre_blood      # [111] Cre_blood_metc13
    Cre_co2c13 = x[38] / Vre_tissue      # [112] Cre_co2c13
    Cre_metc13 = x[39] / Vre_tissue      # [113] Cre_metc13
    Exhalation_co2c13 = p[13] * 60 * Clu_co2c13 / (p[14] + Clu_co2c13)      # [114] Exhalation_co2c13
    Flow_ar_gu_apap = Qgu * Car_apap      # [115] Flow_ar_gu_apap
    Flow_ar_gu_co2c13 = Qgu * Car_co2c13      # [116] Flow_ar_gu_co2c13
    Flow_ar_gu_metc13 = Qgu * Car_metc13      # [117] Flow_ar_gu_metc13
    Flow_ar_he_apap = Qhe * Car_apap      # [118] Flow_ar_he_apap
    Flow_ar_he_co2c13 = Qhe * Car_co2c13      # [119] Flow_ar_he_co2c13
    Flow_ar_he_metc13 = Qhe * Car_metc13      # [120] Flow_ar_he_metc13
    Flow_ar_ki_apap = Qki * Car_apap      # [121] Flow_ar_ki_apap
    Flow_ar_ki_co2c13 = Qki * Car_co2c13      # [122] Flow_ar_ki_co2c13
    Flow_ar_ki_metc13 = Qki * Car_metc13      # [123] Flow_ar_ki_metc13
    Flow_ar_re_apap = Qre * Car_apap      # [124] Flow_ar_re_apap
    Flow_ar_re_co2c13 = Qre * Car_co2c13      # [125] Flow_ar_re_co2c13
    Flow_ar_re_metc13 = Qre * Car_metc13      # [126] Flow_ar_re_metc13
    Flow_ar_sp_apap = Qsp * Car_apap      # [127] Flow_ar_sp_apap
    Flow_ar_sp_co2c13 = Qsp * Car_co2c13      # [128] Flow_ar_sp_co2c13
    Flow_ar_sp_metc13 = Qsp * Car_metc13      # [129] Flow_ar_sp_metc13
    Flow_gu_li_apap = Qgu * Cgu_blood_apap * p[2]      # [130] Flow_gu_li_apap
    Flow_gu_li_co2c13 = Qgu * Cgu_blood_co2c13 * p[3]      # [131] Flow_gu_li_co2c13
    Flow_gu_li_metc13 = Qgu * Cgu_blood_metc13 * p[4]      # [132] Flow_gu_li_metc13
    Flow_he_ve_apap = Qhe * Che_blood_apap * p[2]      # [133] Flow_he_ve_apap
    Flow_he_ve_co2c13 = Qhe * Che_blood_co2c13 * p[3]      # [134] Flow_he_ve_co2c13
    Flow_he_ve_metc13 = Qhe * Che_blood_metc13 * p[4]      # [135] Flow_he_ve_metc13
    Flow_ki_ve_apap = Qki * Cki_blood_apap * p[2]      # [136] Flow_ki_ve_apap
    Flow_ki_ve_co2c13 = Qki * Cki_blood_co2c13 * p[3]      # [137] Flow_ki_ve_co2c13
    Flow_ki_ve_metc13 = Qki * Cki_blood_metc13 * p[4]      # [138] Flow_ki_ve_metc13
    Flow_li_ve_apap = Qh * Cli_blood_apap * p[2]      # [139] Flow_li_ve_apap
    Flow_li_ve_co2c13 = Qh * Cli_blood_co2c13 * p[3]      # [140] Flow_li_ve_co2c13
    Flow_li_ve_metc13 = Qh * Cli_blood_metc13 * p[4]      # [141] Flow_li_ve_metc13
    Flow_lu_ar_apap = Qlu * Clu_blood_apap * p[2]      # [142] Flow_lu_ar_apap
    Flow_lu_ar_co2c13 = Qlu * Clu_blood_co2c13 * p[3]      # [143] Flow_lu_ar_co2c13
    Flow_lu_ar_metc13 = Qlu * Clu_blood_metc13 * p[4]      # [144] Flow_lu_ar_metc13
    Flow_sp_li_apap = Qsp * Csp_blood_apap * p[2]      # [145] Flow_sp_li_apap
    Flow_sp_li_co2c13 = Qsp * Csp_blood_co2c13 * p[3]      # [146] Flow_sp_li_co2c13
    Flow_sp_li_metc13 = Qsp * Csp_blood_metc13 * p[4]      # [147] Flow_sp_li_metc13
    Flow_ve_lu_apap = Qlu * Cve_apap      # [148] Flow_ve_lu_apap
    Flow_ve_lu_co2c13 = Qlu * Cve_co2c13      # [149] Flow_ve_lu_co2c13
    Flow_ve_lu_metc13 = Qlu * Cve_metc13      # [150] Flow_ve_lu_metc13
    Qha = Qh - Qgu - Qsp      # [151] Qha
    RenalClearance_apap = p[6] * Cki_apap      # [152] RenalClearance_apap
    RenalClearance_co2c13 = p[7] * Cki_co2c13      # [153] RenalClearance_co2c13
    RenalClearance_metc13 = p[8] * Cki_metc13      # [154] RenalClearance_metc13
    import_gu_apap = p[53] * Vgu_tissue * (p[40] * Cgu_blood_apap - Cgu_apap)      # [155] import_gu_apap
    import_gu_co2c13 = p[54] * Vgu_tissue * (p[41] * Cgu_blood_co2c13 - Cgu_co2c13)      # [156] import_gu_co2c13
    import_gu_metc13 = p[55] * Vgu_tissue * (p[42] * Cgu_blood_metc13 - Cgu_metc13)      # [157] import_gu_metc13
    import_he_apap = p[53] * Vhe_tissue * (p[40] * Che_blood_apap - Che_apap)      # [158] import_he_apap
    import_he_co2c13 = p[54] * Vhe_tissue * (p[41] * Che_blood_co2c13 - Che_co2c13)      # [159] import_he_co2c13
    import_he_metc13 = p[55] * Vhe_tissue * (p[42] * Che_blood_metc13 - Che_metc13)      # [160] import_he_metc13
    import_ki_apap = p[53] * Vki_tissue * (p[40] * Cki_blood_apap - Cki_apap)      # [161] import_ki_apap
    import_ki_co2c13 = p[54] * Vki_tissue * (p[41] * Cki_blood_co2c13 - Cki_co2c13)      # [162] import_ki_co2c13
    import_ki_metc13 = p[55] * Vki_tissue * (p[42] * Cki_blood_metc13 - Cki_metc13)      # [163] import_ki_metc13
    import_li_apap = p[53] * Vli_tissue * (p[40] * Cli_blood_apap - Cli_apap)      # [164] import_li_apap
    import_li_co2c13 = p[54] * Vli_tissue * (p[41] * Cli_blood_co2c13 - Cli_co2c13)      # [165] import_li_co2c13
    import_li_metc13 = p[55] * Vli_tissue * (p[42] * Cli_blood_metc13 - Cli_metc13)      # [166] import_li_metc13
    import_lu_apap = p[53] * Vlu_tissue * (p[40] * Clu_blood_apap - Clu_apap)      # [167] import_lu_apap
    import_lu_co2c13 = p[54] * Vlu_tissue * (p[41] * Clu_blood_co2c13 - Clu_co2c13)      # [168] import_lu_co2c13
    import_lu_metc13 = p[55] * Vlu_tissue * (p[42] * Clu_blood_metc13 - Clu_metc13)      # [169] import_lu_metc13
    import_sp_apap = p[53] * Vsp_tissue * (p[40] * Csp_blood_apap - Csp_apap)      # [170] import_sp_apap
    import_sp_co2c13 = p[54] * Vsp_tissue * (p[41] * Csp_blood_co2c13 - Csp_co2c13)      # [171] import_sp_co2c13
    import_sp_metc13 = p[55] * Vsp_tissue * (p[42] * Csp_blood_metc13 - Csp_metc13)      # [172] import_sp_metc13
    Flow_ar_li_apap = Qha * Car_apap      # [173] Flow_ar_li_apap
    Flow_ar_li_co2c13 = Qha * Car_co2c13      # [174] Flow_ar_li_co2c13
    Flow_ar_li_metc13 = Qha * Car_metc13      # [175] Flow_ar_li_metc13
    Flow_re_ve_apap = Qre * Cre_blood_apap * p[2]      # [176] Flow_re_ve_apap
    Flow_re_ve_co2c13 = Qre * Cre_blood_co2c13 * p[3]      # [177] Flow_re_ve_co2c13
    Flow_re_ve_metc13 = Qre * Cre_blood_metc13 * p[4]      # [178] Flow_re_ve_metc13
    P_CO2c13 = (p[48] / (1 + p[48])) * P_CO2 + Exhalation_co2c13 / 60      # [179] P_CO2c13
    import_re_apap = p[53] * Vre_tissue * (p[40] * Cre_blood_apap - Cre_apap)      # [180] import_re_apap
    import_re_co2c13 = p[54] * Vre_tissue * (p[41] * Cre_blood_co2c13 - Cre_co2c13)      # [181] import_re_co2c13
    import_re_metc13 = p[55] * Vre_tissue * (p[42] * Cre_blood_metc13 - Cre_metc13)      # [182] import_re_metc13
    DOB = ((P_CO2c13 / P_CO2c12 - p[48]) / p[48]) * 1000      # [183] DOB
    P_CO2Fc13 = P_CO2c13 / (P_CO2c12 + P_CO2c13)      # [184] P_CO2Fc13
    P_CO2R = P_CO2c13 / P_CO2c12      # [185] P_CO2R

    # ode
    return [
        (-Flow_ar_gu_apap - Flow_ar_he_apap - Flow_ar_ki_apap - Flow_ar_li_apap) + Flow_lu_ar_apap - Flow_ar_sp_apap - Flow_ar_re_apap,       # [0] Aar_apap
        (-Flow_ar_gu_co2c13 - Flow_ar_he_co2c13 - Flow_ar_ki_co2c13 - Flow_ar_li_co2c13) + Flow_lu_ar_co2c13 - Flow_ar_sp_co2c13 - Flow_ar_re_co2c13,       # [1] Aar_co2c13
        (-Flow_ar_gu_metc13 - Flow_ar_he_metc13 - Flow_ar_ki_metc13 - Flow_ar_li_metc13) + Flow_lu_ar_metc13 - Flow_ar_sp_metc13 - Flow_ar_re_metc13,       # [2] Aar_metc13
        Exhalation_co2c13,       # [3] Abreath_co2c13
        import_gu_apap,       # [4] Agu_apap
        (Absorption_apap - import_gu_apap) + Flow_ar_gu_apap - Flow_gu_li_apap,       # [5] Agu_blood_apap
        (Absorption_co2c13 - import_gu_co2c13) + Flow_ar_gu_co2c13 - Flow_gu_li_co2c13,       # [6] Agu_blood_co2c13
        (Absorption_metc13 - import_gu_metc13) + Flow_ar_gu_metc13 - Flow_gu_li_metc13,       # [7] Agu_blood_metc13
        import_gu_co2c13,       # [8] Agu_co2c13
        import_gu_metc13,       # [9] Agu_metc13
        import_he_apap,       # [10] Ahe_apap
        -import_he_apap + Flow_ar_he_apap - Flow_he_ve_apap,       # [11] Ahe_blood_apap
        -import_he_co2c13 + Flow_ar_he_co2c13 - Flow_he_ve_co2c13,       # [12] Ahe_blood_co2c13
        -import_he_metc13 + Flow_ar_he_metc13 - Flow_he_ve_metc13,       # [13] Ahe_blood_metc13
        import_he_co2c13,       # [14] Ahe_co2c13
        import_he_metc13,       # [15] Ahe_metc13
        -RenalClearance_apap + import_ki_apap,       # [16] Aki_apap
        -import_ki_apap + Flow_ar_ki_apap - Flow_ki_ve_apap,       # [17] Aki_blood_apap
        -import_ki_co2c13 + Flow_ar_ki_co2c13 - Flow_ki_ve_co2c13,       # [18] Aki_blood_co2c13
        -import_ki_metc13 + Flow_ar_ki_metc13 - Flow_ki_ve_metc13,       # [19] Aki_blood_metc13
        -RenalClearance_co2c13 + import_ki_co2c13,       # [20] Aki_co2c13
        -RenalClearance_metc13 + import_ki_metc13,       # [21] Aki_metc13
        (CYP1A2MET - APAPD) + import_li_apap,       # [22] Ali_apap
        ((Flow_gu_li_apap - import_li_apap) + Flow_ar_li_apap - Flow_li_ve_apap) + Flow_sp_li_apap,       # [23] Ali_blood_apap
        ((Flow_gu_li_co2c13 - import_li_co2c13) + Flow_ar_li_co2c13 - Flow_li_ve_co2c13) + Flow_sp_li_co2c13,       # [24] Ali_blood_co2c13
        ((Flow_gu_li_metc13 - import_li_metc13) + Flow_ar_li_metc13 - Flow_li_ve_metc13) + Flow_sp_li_metc13,       # [25] Ali_blood_metc13
        CYP1A2MET + import_li_co2c13,       # [26] Ali_co2c13
        -CYP1A2MET + import_li_metc13,       # [27] Ali_metc13
        import_lu_apap,       # [28] Alu_apap
        -import_lu_apap + Flow_ve_lu_apap - Flow_lu_ar_apap,       # [29] Alu_blood_apap
        -import_lu_co2c13 + Flow_ve_lu_co2c13 - Flow_lu_ar_co2c13,       # [30] Alu_blood_co2c13
        -import_lu_metc13 + Flow_ve_lu_metc13 - Flow_lu_ar_metc13,       # [31] Alu_blood_metc13
        -Exhalation_co2c13 + import_lu_co2c13,       # [32] Alu_co2c13
        import_lu_metc13,       # [33] Alu_metc13
        import_re_apap,       # [34] Are_apap
        -import_re_apap + Flow_ar_re_apap - Flow_re_ve_apap,       # [35] Are_blood_apap
        -import_re_co2c13 + Flow_ar_re_co2c13 - Flow_re_ve_co2c13,       # [36] Are_blood_co2c13
        -import_re_metc13 + Flow_ar_re_metc13 - Flow_re_ve_metc13,       # [37] Are_blood_metc13
        import_re_co2c13,       # [38] Are_co2c13
        import_re_metc13,       # [39] Are_metc13
        import_sp_apap,       # [40] Asp_apap
        -import_sp_apap + Flow_ar_sp_apap - Flow_sp_li_apap,       # [41] Asp_blood_apap
        -import_sp_co2c13 + Flow_ar_sp_co2c13 - Flow_sp_li_co2c13,       # [42] Asp_blood_co2c13
        -import_sp_metc13 + Flow_ar_sp_metc13 - Flow_sp_li_metc13,       # [43] Asp_blood_metc13
        import_sp_co2c13,       # [44] Asp_co2c13
        import_sp_metc13,       # [45] Asp_metc13
        RenalClearance_apap,       # [46] Aurine_apap
        RenalClearance_co2c13,       # [47] Aurine_co2c13
        RenalClearance_metc13,       # [48] Aurine_metc13
        (Injection_apap + Infusion_apap + Flow_he_ve_apap + Flow_ki_ve_apap + Flow_li_ve_apap - Flow_ve_lu_apap) + Flow_re_ve_apap,       # [49] Ave_apap
        (Injection_co2c13 + Infusion_co2c13 + Flow_he_ve_co2c13 + Flow_ki_ve_co2c13 + Flow_li_ve_co2c13 - Flow_ve_lu_co2c13) + Flow_re_ve_co2c13,       # [50] Ave_co2c13
        (Injection_metc13 + Infusion_metc13 + Flow_he_ve_metc13 + Flow_ki_ve_metc13 + Flow_li_ve_metc13 - Flow_ve_lu_metc13) + Flow_re_ve_metc13,       # [51] Ave_metc13
        -Injection_apap * p[44],       # [52] IVDOSE_apap
        -Injection_co2c13 * p[45],       # [53] IVDOSE_co2c13
        -Injection_metc13 * p[46],       # [54] IVDOSE_metc13
        -Absorption_apap * p[44],       # [55] PODOSE_apap
        -Absorption_co2c13 * p[45],       # [56] PODOSE_co2c13
        -Absorption_metc13 * p[46],       # [57] PODOSE_metc13
        p[49] * 60,       # [58] cum_dose_apap
        p[50] * 60,       # [59] cum_dose_co2c13
        p[51] * 60,       # [60] cum_dose_metc13
    ]


def f_y(x, t, p):
    """ Calculate y.
    :param x:
    :param t:
    :param p:
    :return:
    """

    Absorption_apap = (p[37] * x[55] / p[44]) * p[30]  # [0] Absorption_apap
    Absorption_co2c13 = (p[38] * x[56] / p[45]) * p[31]  # [1] Absorption_co2c13
    Absorption_metc13 = (p[39] * x[57] / p[46]) * p[32]  # [2] Absorption_metc13
    BSA = 0.024265 * (p[5] / 1)**0.5378 * (p[34] / 1)**0.3964  # [3] BSA
    CO = p[5] * p[9] + (p[35] - p[36]) * p[10] / 60  # [4] CO
    FQre = 1 - (p[17] + p[15] + p[18] + p[16] + p[20])  # [5] FQre
    FVre = 1 - (p[23] + p[22] + p[24] + p[25] + p[26] + p[27] + p[28] + p[21])  # [6] FVre
    Infusion_apap = (p[49] / p[44]) * 60  # [7] Infusion_apap
    Infusion_co2c13 = (p[50] / p[45]) * 60  # [8] Infusion_co2c13
    Infusion_metc13 = (p[51] / p[46]) * 60  # [9] Infusion_metc13
    Ki_apap = (1.386 / p[57]) * 3600  # [10] Ki_apap
    Ki_co2c13 = (1.386 / p[58]) * 3600  # [11] Ki_co2c13
    Ki_metc13 = (1.386 / p[59]) * 3600  # [12] Ki_metc13
    Var = p[5] * p[21] - (p[21] / (p[21] + p[28])) * p[5] * p[33] * (1 - p[28] - p[21])  # [13] Var
    Vgu = p[5] * p[22]  # [14] Vgu
    Vhe = p[5] * p[23]  # [15] Vhe
    Vki = p[5] * p[24]  # [16] Vki
    Vli = p[5] * p[25]  # [17] Vli
    Vlu = p[5] * p[26]  # [18] Vlu
    Vsp = p[5] * p[27]  # [19] Vsp
    Vve = p[5] * p[28] - (p[28] / (p[21] + p[28])) * p[5] * p[33] * (1 - p[28] - p[21])  # [20] Vve
    Xbreath_co2c13 = x[3] * p[45]  # [21] Xbreath_co2c13
    Xurine_apap = x[46] * p[44]  # [22] Xurine_apap
    Xurine_co2c13 = x[47] * p[45]  # [23] Xurine_co2c13
    Xurine_metc13 = x[48] * p[46]  # [24] Xurine_metc13
    APAPD_CLliv = p[0] * p[43] * Vli * p[29] * 60 / 1000  # [25] APAPD_CLliv
    CYP1A2MET_CLliv = p[11] * p[43] * Vli * p[29] * 60 / 1000  # [26] CYP1A2MET_CLliv
    Car_apap = x[0] / Var  # [27] Car_apap
    Car_co2c13 = x[1] / Var  # [28] Car_co2c13
    Car_metc13 = x[2] / Var  # [29] Car_metc13
    Cve_apap = x[49] / Vve  # [30] Cve_apap
    Cve_co2c13 = x[50] / Vve  # [31] Cve_co2c13
    Cve_metc13 = x[51] / Vve  # [32] Cve_metc13
    Injection_apap = Ki_apap * x[52] / p[44]  # [33] Injection_apap
    Injection_co2c13 = Ki_co2c13 * x[53] / p[45]  # [34] Injection_co2c13
    Injection_metc13 = Ki_metc13 * x[54] / p[46]  # [35] Injection_metc13
    P_CO2 = BSA * p[47] / 60  # [36] P_CO2
    QC = (CO / 1000) * 3600  # [37] QC
    Vgu_blood = Vgu * p[33]  # [38] Vgu_blood
    Vgu_tissue = Vgu * (1 - p[33])  # [39] Vgu_tissue
    Vhe_blood = Vhe * p[33]  # [40] Vhe_blood
    Vhe_tissue = Vhe * (1 - p[33])  # [41] Vhe_tissue
    Vki_blood = Vki * p[33]  # [42] Vki_blood
    Vki_tissue = Vki * (1 - p[33])  # [43] Vki_tissue
    Vli_blood = Vli * p[33]  # [44] Vli_blood
    Vli_tissue = Vli * (1 - p[33])  # [45] Vli_tissue
    Vlu_blood = Vlu * p[33]  # [46] Vlu_blood
    Vlu_tissue = Vlu * (1 - p[33])  # [47] Vlu_tissue
    Vre = p[5] * FVre  # [48] Vre
    Vsp_blood = Vsp * p[33]  # [49] Vsp_blood
    Vsp_tissue = Vsp * (1 - p[33])  # [50] Vsp_tissue
    Cgu_apap = x[4] / Vgu_tissue  # [51] Cgu_apap
    Cgu_blood_apap = x[5] / Vgu_blood  # [52] Cgu_blood_apap
    Cgu_blood_co2c13 = x[6] / Vgu_blood  # [53] Cgu_blood_co2c13
    Cgu_blood_metc13 = x[7] / Vgu_blood  # [54] Cgu_blood_metc13
    Cgu_co2c13 = x[8] / Vgu_tissue  # [55] Cgu_co2c13
    Cgu_metc13 = x[9] / Vgu_tissue  # [56] Cgu_metc13
    Che_apap = x[10] / Vhe_tissue  # [57] Che_apap
    Che_blood_apap = x[11] / Vhe_blood  # [58] Che_blood_apap
    Che_blood_co2c13 = x[12] / Vhe_blood  # [59] Che_blood_co2c13
    Che_blood_metc13 = x[13] / Vhe_blood  # [60] Che_blood_metc13
    Che_co2c13 = x[14] / Vhe_tissue  # [61] Che_co2c13
    Che_metc13 = x[15] / Vhe_tissue  # [62] Che_metc13
    Cki_apap = x[16] / Vki_tissue  # [63] Cki_apap
    Cki_blood_apap = x[17] / Vki_blood  # [64] Cki_blood_apap
    Cki_blood_co2c13 = x[18] / Vki_blood  # [65] Cki_blood_co2c13
    Cki_blood_metc13 = x[19] / Vki_blood  # [66] Cki_blood_metc13
    Cki_co2c13 = x[20] / Vki_tissue  # [67] Cki_co2c13
    Cki_metc13 = x[21] / Vki_tissue  # [68] Cki_metc13
    Cli_apap = x[22] / Vli_tissue  # [69] Cli_apap
    Cli_blood_apap = x[23] / Vli_blood  # [70] Cli_blood_apap
    Cli_blood_co2c13 = x[24] / Vli_blood  # [71] Cli_blood_co2c13
    Cli_blood_metc13 = x[25] / Vli_blood  # [72] Cli_blood_metc13
    Cli_co2c13 = x[26] / Vli_tissue  # [73] Cli_co2c13
    Cli_metc13 = x[27] / Vli_tissue  # [74] Cli_metc13
    Clu_apap = x[28] / Vlu_tissue  # [75] Clu_apap
    Clu_blood_apap = x[29] / Vlu_blood  # [76] Clu_blood_apap
    Clu_blood_co2c13 = x[30] / Vlu_blood  # [77] Clu_blood_co2c13
    Clu_blood_metc13 = x[31] / Vlu_blood  # [78] Clu_blood_metc13
    Clu_co2c13 = x[32] / Vlu_tissue  # [79] Clu_co2c13
    Clu_metc13 = x[33] / Vlu_tissue  # [80] Clu_metc13
    Cpl_ve_apap = Cve_apap / p[2]  # [81] Cpl_ve_apap
    Cpl_ve_co2c13 = Cve_co2c13 / p[3]  # [82] Cpl_ve_co2c13
    Cpl_ve_metc13 = Cve_metc13 / p[4]  # [83] Cpl_ve_metc13
    Csp_apap = x[40] / Vsp_tissue  # [84] Csp_apap
    Csp_blood_apap = x[41] / Vsp_blood  # [85] Csp_blood_apap
    Csp_blood_co2c13 = x[42] / Vsp_blood  # [86] Csp_blood_co2c13
    Csp_blood_metc13 = x[43] / Vsp_blood  # [87] Csp_blood_metc13
    Csp_co2c13 = x[44] / Vsp_tissue  # [88] Csp_co2c13
    Csp_metc13 = x[45] / Vsp_tissue  # [89] Csp_metc13
    Mar_apap = Car_apap * p[44]  # [90] Mar_apap
    Mar_co2c13 = Car_co2c13 * p[45]  # [91] Mar_co2c13
    Mar_metc13 = Car_metc13 * p[46]  # [92] Mar_metc13
    Mve_apap = Cve_apap * p[44]  # [93] Mve_apap
    Mve_co2c13 = Cve_co2c13 * p[45]  # [94] Mve_co2c13
    Mve_metc13 = Cve_metc13 * p[46]  # [95] Mve_metc13
    P_CO2c12 = (1 / (1 + p[48])) * P_CO2  # [96] P_CO2c12
    Qgu = QC * p[15]  # [97] Qgu
    Qh = QC * p[16]  # [98] Qh
    Qhe = QC * p[17]  # [99] Qhe
    Qki = QC * p[18]  # [100] Qki
    Qlu = QC * p[19]  # [101] Qlu
    Qre = QC * FQre  # [102] Qre
    Qsp = QC * p[20]  # [103] Qsp
    Vre_blood = Vre * p[33]  # [104] Vre_blood
    Vre_tissue = Vre * (1 - p[33])  # [105] Vre_tissue
    APAPD = APAPD_CLliv * 1 * (Cli_apap / (Cli_apap + p[1]))  # [106] APAPD
    CYP1A2MET = CYP1A2MET_CLliv * 1 * (Cli_metc13 / (Cli_metc13 + p[12]))  # [107] CYP1A2MET
    Cre_apap = x[34] / Vre_tissue  # [108] Cre_apap
    Cre_blood_apap = x[35] / Vre_blood  # [109] Cre_blood_apap
    Cre_blood_co2c13 = x[36] / Vre_blood  # [110] Cre_blood_co2c13
    Cre_blood_metc13 = x[37] / Vre_blood  # [111] Cre_blood_metc13
    Cre_co2c13 = x[38] / Vre_tissue  # [112] Cre_co2c13
    Cre_metc13 = x[39] / Vre_tissue  # [113] Cre_metc13
    Exhalation_co2c13 = p[13] * 60 * Clu_co2c13 / (p[14] + Clu_co2c13)  # [114] Exhalation_co2c13
    Flow_ar_gu_apap = Qgu * Car_apap  # [115] Flow_ar_gu_apap
    Flow_ar_gu_co2c13 = Qgu * Car_co2c13  # [116] Flow_ar_gu_co2c13
    Flow_ar_gu_metc13 = Qgu * Car_metc13  # [117] Flow_ar_gu_metc13
    Flow_ar_he_apap = Qhe * Car_apap  # [118] Flow_ar_he_apap
    Flow_ar_he_co2c13 = Qhe * Car_co2c13  # [119] Flow_ar_he_co2c13
    Flow_ar_he_metc13 = Qhe * Car_metc13  # [120] Flow_ar_he_metc13
    Flow_ar_ki_apap = Qki * Car_apap  # [121] Flow_ar_ki_apap
    Flow_ar_ki_co2c13 = Qki * Car_co2c13  # [122] Flow_ar_ki_co2c13
    Flow_ar_ki_metc13 = Qki * Car_metc13  # [123] Flow_ar_ki_metc13
    Flow_ar_re_apap = Qre * Car_apap  # [124] Flow_ar_re_apap
    Flow_ar_re_co2c13 = Qre * Car_co2c13  # [125] Flow_ar_re_co2c13
    Flow_ar_re_metc13 = Qre * Car_metc13  # [126] Flow_ar_re_metc13
    Flow_ar_sp_apap = Qsp * Car_apap  # [127] Flow_ar_sp_apap
    Flow_ar_sp_co2c13 = Qsp * Car_co2c13  # [128] Flow_ar_sp_co2c13
    Flow_ar_sp_metc13 = Qsp * Car_metc13  # [129] Flow_ar_sp_metc13
    Flow_gu_li_apap = Qgu * Cgu_blood_apap * p[2]  # [130] Flow_gu_li_apap
    Flow_gu_li_co2c13 = Qgu * Cgu_blood_co2c13 * p[3]  # [131] Flow_gu_li_co2c13
    Flow_gu_li_metc13 = Qgu * Cgu_blood_metc13 * p[4]  # [132] Flow_gu_li_metc13
    Flow_he_ve_apap = Qhe * Che_blood_apap * p[2]  # [133] Flow_he_ve_apap
    Flow_he_ve_co2c13 = Qhe * Che_blood_co2c13 * p[3]  # [134] Flow_he_ve_co2c13
    Flow_he_ve_metc13 = Qhe * Che_blood_metc13 * p[4]  # [135] Flow_he_ve_metc13
    Flow_ki_ve_apap = Qki * Cki_blood_apap * p[2]  # [136] Flow_ki_ve_apap
    Flow_ki_ve_co2c13 = Qki * Cki_blood_co2c13 * p[3]  # [137] Flow_ki_ve_co2c13
    Flow_ki_ve_metc13 = Qki * Cki_blood_metc13 * p[4]  # [138] Flow_ki_ve_metc13
    Flow_li_ve_apap = Qh * Cli_blood_apap * p[2]  # [139] Flow_li_ve_apap
    Flow_li_ve_co2c13 = Qh * Cli_blood_co2c13 * p[3]  # [140] Flow_li_ve_co2c13
    Flow_li_ve_metc13 = Qh * Cli_blood_metc13 * p[4]  # [141] Flow_li_ve_metc13
    Flow_lu_ar_apap = Qlu * Clu_blood_apap * p[2]  # [142] Flow_lu_ar_apap
    Flow_lu_ar_co2c13 = Qlu * Clu_blood_co2c13 * p[3]  # [143] Flow_lu_ar_co2c13
    Flow_lu_ar_metc13 = Qlu * Clu_blood_metc13 * p[4]  # [144] Flow_lu_ar_metc13
    Flow_sp_li_apap = Qsp * Csp_blood_apap * p[2]  # [145] Flow_sp_li_apap
    Flow_sp_li_co2c13 = Qsp * Csp_blood_co2c13 * p[3]  # [146] Flow_sp_li_co2c13
    Flow_sp_li_metc13 = Qsp * Csp_blood_metc13 * p[4]  # [147] Flow_sp_li_metc13
    Flow_ve_lu_apap = Qlu * Cve_apap  # [148] Flow_ve_lu_apap
    Flow_ve_lu_co2c13 = Qlu * Cve_co2c13  # [149] Flow_ve_lu_co2c13
    Flow_ve_lu_metc13 = Qlu * Cve_metc13  # [150] Flow_ve_lu_metc13
    Qha = Qh - Qgu - Qsp  # [151] Qha
    RenalClearance_apap = p[6] * Cki_apap  # [152] RenalClearance_apap
    RenalClearance_co2c13 = p[7] * Cki_co2c13  # [153] RenalClearance_co2c13
    RenalClearance_metc13 = p[8] * Cki_metc13  # [154] RenalClearance_metc13
    import_gu_apap = p[53] * Vgu_tissue * (p[40] * Cgu_blood_apap - Cgu_apap)  # [155] import_gu_apap
    import_gu_co2c13 = p[54] * Vgu_tissue * (p[41] * Cgu_blood_co2c13 - Cgu_co2c13)  # [156] import_gu_co2c13
    import_gu_metc13 = p[55] * Vgu_tissue * (p[42] * Cgu_blood_metc13 - Cgu_metc13)  # [157] import_gu_metc13
    import_he_apap = p[53] * Vhe_tissue * (p[40] * Che_blood_apap - Che_apap)  # [158] import_he_apap
    import_he_co2c13 = p[54] * Vhe_tissue * (p[41] * Che_blood_co2c13 - Che_co2c13)  # [159] import_he_co2c13
    import_he_metc13 = p[55] * Vhe_tissue * (p[42] * Che_blood_metc13 - Che_metc13)  # [160] import_he_metc13
    import_ki_apap = p[53] * Vki_tissue * (p[40] * Cki_blood_apap - Cki_apap)  # [161] import_ki_apap
    import_ki_co2c13 = p[54] * Vki_tissue * (p[41] * Cki_blood_co2c13 - Cki_co2c13)  # [162] import_ki_co2c13
    import_ki_metc13 = p[55] * Vki_tissue * (p[42] * Cki_blood_metc13 - Cki_metc13)  # [163] import_ki_metc13
    import_li_apap = p[53] * Vli_tissue * (p[40] * Cli_blood_apap - Cli_apap)  # [164] import_li_apap
    import_li_co2c13 = p[54] * Vli_tissue * (p[41] * Cli_blood_co2c13 - Cli_co2c13)  # [165] import_li_co2c13
    import_li_metc13 = p[55] * Vli_tissue * (p[42] * Cli_blood_metc13 - Cli_metc13)  # [166] import_li_metc13
    import_lu_apap = p[53] * Vlu_tissue * (p[40] * Clu_blood_apap - Clu_apap)  # [167] import_lu_apap
    import_lu_co2c13 = p[54] * Vlu_tissue * (p[41] * Clu_blood_co2c13 - Clu_co2c13)  # [168] import_lu_co2c13
    import_lu_metc13 = p[55] * Vlu_tissue * (p[42] * Clu_blood_metc13 - Clu_metc13)  # [169] import_lu_metc13
    import_sp_apap = p[53] * Vsp_tissue * (p[40] * Csp_blood_apap - Csp_apap)  # [170] import_sp_apap
    import_sp_co2c13 = p[54] * Vsp_tissue * (p[41] * Csp_blood_co2c13 - Csp_co2c13)  # [171] import_sp_co2c13
    import_sp_metc13 = p[55] * Vsp_tissue * (p[42] * Csp_blood_metc13 - Csp_metc13)  # [172] import_sp_metc13
    Flow_ar_li_apap = Qha * Car_apap  # [173] Flow_ar_li_apap
    Flow_ar_li_co2c13 = Qha * Car_co2c13  # [174] Flow_ar_li_co2c13
    Flow_ar_li_metc13 = Qha * Car_metc13  # [175] Flow_ar_li_metc13
    Flow_re_ve_apap = Qre * Cre_blood_apap * p[2]  # [176] Flow_re_ve_apap
    Flow_re_ve_co2c13 = Qre * Cre_blood_co2c13 * p[3]  # [177] Flow_re_ve_co2c13
    Flow_re_ve_metc13 = Qre * Cre_blood_metc13 * p[4]  # [178] Flow_re_ve_metc13
    P_CO2c13 = (p[48] / (1 + p[48])) * P_CO2 + Exhalation_co2c13 / 60  # [179] P_CO2c13
    import_re_apap = p[53] * Vre_tissue * (p[40] * Cre_blood_apap - Cre_apap)  # [180] import_re_apap
    import_re_co2c13 = p[54] * Vre_tissue * (p[41] * Cre_blood_co2c13 - Cre_co2c13)  # [181] import_re_co2c13
    import_re_metc13 = p[55] * Vre_tissue * (p[42] * Cre_blood_metc13 - Cre_metc13)  # [182] import_re_metc13
    DOB = ((P_CO2c13 / P_CO2c12 - p[48]) / p[48]) * 1000  # [183] DOB
    P_CO2Fc13 = P_CO2c13 / (P_CO2c12 + P_CO2c13)  # [184] P_CO2Fc13
    P_CO2R = P_CO2c13 / P_CO2c12  # [185] P_CO2R

    # --------------------------------------

    y = np.empty(shape=(186))
    y[0] = Absorption_apap  # [0] Absorption_apap
    y[1] = Absorption_co2c13  # [1] Absorption_co2c13
    y[2] = Absorption_metc13  # [2] Absorption_metc13
    y[3] = BSA  # [3] BSA
    y[4] = CO  # [4] CO
    y[5] = FQre  # [5] FQre
    y[6] = FVre  # [6] FVre
    y[7] = Infusion_apap  # [7] Infusion_apap
    y[8] = Infusion_co2c13  # [8] Infusion_co2c13
    y[9] = Infusion_metc13  # [9] Infusion_metc13
    y[10] = Ki_apap  # [10] Ki_apap
    y[11] = Ki_co2c13  # [11] Ki_co2c13
    y[12] = Ki_metc13  # [12] Ki_metc13
    y[13] = Var  # [13] Var
    y[14] = Vgu  # [14] Vgu
    y[15] = Vhe  # [15] Vhe
    y[16] = Vki  # [16] Vki
    y[17] = Vli  # [17] Vli
    y[18] = Vlu  # [18] Vlu
    y[19] = Vsp  # [19] Vsp
    y[20] = Vve  # [20] Vve
    y[21] = Xbreath_co2c13  # [21] Xbreath_co2c13
    y[22] = Xurine_apap  # [22] Xurine_apap
    y[23] = Xurine_co2c13  # [23] Xurine_co2c13
    y[24] = Xurine_metc13  # [24] Xurine_metc13
    y[25] = APAPD_CLliv  # [25] APAPD_CLliv
    y[26] = CYP1A2MET_CLliv  # [26] CYP1A2MET_CLliv
    y[27] = Car_apap  # [27] Car_apap
    y[28] = Car_co2c13  # [28] Car_co2c13
    y[29] = Car_metc13  # [29] Car_metc13
    y[30] = Cve_apap  # [30] Cve_apap
    y[31] = Cve_co2c13  # [31] Cve_co2c13
    y[32] = Cve_metc13  # [32] Cve_metc13
    y[33] = Injection_apap  # [33] Injection_apap
    y[34] = Injection_co2c13  # [34] Injection_co2c13
    y[35] = Injection_metc13  # [35] Injection_metc13
    y[36] = P_CO2  # [36] P_CO2
    y[37] = QC  # [37] QC
    y[38] = Vgu_blood  # [38] Vgu_blood
    y[39] = Vgu_tissue  # [39] Vgu_tissue
    y[40] = Vhe_blood  # [40] Vhe_blood
    y[41] = Vhe_tissue  # [41] Vhe_tissue
    y[42] = Vki_blood  # [42] Vki_blood
    y[43] = Vki_tissue  # [43] Vki_tissue
    y[44] = Vli_blood  # [44] Vli_blood
    y[45] = Vli_tissue  # [45] Vli_tissue
    y[46] = Vlu_blood  # [46] Vlu_blood
    y[47] = Vlu_tissue  # [47] Vlu_tissue
    y[48] = Vre  # [48] Vre
    y[49] = Vsp_blood  # [49] Vsp_blood
    y[50] = Vsp_tissue  # [50] Vsp_tissue
    y[51] = Cgu_apap  # [51] Cgu_apap
    y[52] = Cgu_blood_apap  # [52] Cgu_blood_apap
    y[53] = Cgu_blood_co2c13  # [53] Cgu_blood_co2c13
    y[54] = Cgu_blood_metc13  # [54] Cgu_blood_metc13
    y[55] = Cgu_co2c13  # [55] Cgu_co2c13
    y[56] = Cgu_metc13  # [56] Cgu_metc13
    y[57] = Che_apap  # [57] Che_apap
    y[58] = Che_blood_apap  # [58] Che_blood_apap
    y[59] = Che_blood_co2c13  # [59] Che_blood_co2c13
    y[60] = Che_blood_metc13  # [60] Che_blood_metc13
    y[61] = Che_co2c13  # [61] Che_co2c13
    y[62] = Che_metc13  # [62] Che_metc13
    y[63] = Cki_apap  # [63] Cki_apap
    y[64] = Cki_blood_apap  # [64] Cki_blood_apap
    y[65] = Cki_blood_co2c13  # [65] Cki_blood_co2c13
    y[66] = Cki_blood_metc13  # [66] Cki_blood_metc13
    y[67] = Cki_co2c13  # [67] Cki_co2c13
    y[68] = Cki_metc13  # [68] Cki_metc13
    y[69] = Cli_apap  # [69] Cli_apap
    y[70] = Cli_blood_apap  # [70] Cli_blood_apap
    y[71] = Cli_blood_co2c13  # [71] Cli_blood_co2c13
    y[72] = Cli_blood_metc13  # [72] Cli_blood_metc13
    y[73] = Cli_co2c13  # [73] Cli_co2c13
    y[74] = Cli_metc13  # [74] Cli_metc13
    y[75] = Clu_apap  # [75] Clu_apap
    y[76] = Clu_blood_apap  # [76] Clu_blood_apap
    y[77] = Clu_blood_co2c13  # [77] Clu_blood_co2c13
    y[78] = Clu_blood_metc13  # [78] Clu_blood_metc13
    y[79] = Clu_co2c13  # [79] Clu_co2c13
    y[80] = Clu_metc13  # [80] Clu_metc13
    y[81] = Cpl_ve_apap  # [81] Cpl_ve_apap
    y[82] = Cpl_ve_co2c13  # [82] Cpl_ve_co2c13
    y[83] = Cpl_ve_metc13  # [83] Cpl_ve_metc13
    y[84] = Csp_apap  # [84] Csp_apap
    y[85] = Csp_blood_apap  # [85] Csp_blood_apap
    y[86] = Csp_blood_co2c13  # [86] Csp_blood_co2c13
    y[87] = Csp_blood_metc13  # [87] Csp_blood_metc13
    y[88] = Csp_co2c13  # [88] Csp_co2c13
    y[89] = Csp_metc13  # [89] Csp_metc13
    y[90] = Mar_apap  # [90] Mar_apap
    y[91] = Mar_co2c13  # [91] Mar_co2c13
    y[92] = Mar_metc13  # [92] Mar_metc13
    y[93] = Mve_apap  # [93] Mve_apap
    y[94] = Mve_co2c13  # [94] Mve_co2c13
    y[95] = Mve_metc13  # [95] Mve_metc13
    y[96] = P_CO2c12  # [96] P_CO2c12
    y[97] = Qgu  # [97] Qgu
    y[98] = Qh  # [98] Qh
    y[99] = Qhe  # [99] Qhe
    y[100] = Qki  # [100] Qki
    y[101] = Qlu  # [101] Qlu
    y[102] = Qre  # [102] Qre
    y[103] = Qsp  # [103] Qsp
    y[104] = Vre_blood  # [104] Vre_blood
    y[105] = Vre_tissue  # [105] Vre_tissue
    y[106] = APAPD  # [106] APAPD
    y[107] = CYP1A2MET  # [107] CYP1A2MET
    y[108] = Cre_apap  # [108] Cre_apap
    y[109] = Cre_blood_apap  # [109] Cre_blood_apap
    y[110] = Cre_blood_co2c13  # [110] Cre_blood_co2c13
    y[111] = Cre_blood_metc13  # [111] Cre_blood_metc13
    y[112] = Cre_co2c13  # [112] Cre_co2c13
    y[113] = Cre_metc13  # [113] Cre_metc13
    y[114] = Exhalation_co2c13  # [114] Exhalation_co2c13
    y[115] = Flow_ar_gu_apap  # [115] Flow_ar_gu_apap
    y[116] = Flow_ar_gu_co2c13  # [116] Flow_ar_gu_co2c13
    y[117] = Flow_ar_gu_metc13  # [117] Flow_ar_gu_metc13
    y[118] = Flow_ar_he_apap  # [118] Flow_ar_he_apap
    y[119] = Flow_ar_he_co2c13  # [119] Flow_ar_he_co2c13
    y[120] = Flow_ar_he_metc13  # [120] Flow_ar_he_metc13
    y[121] = Flow_ar_ki_apap  # [121] Flow_ar_ki_apap
    y[122] = Flow_ar_ki_co2c13  # [122] Flow_ar_ki_co2c13
    y[123] = Flow_ar_ki_metc13  # [123] Flow_ar_ki_metc13
    y[124] = Flow_ar_re_apap  # [124] Flow_ar_re_apap
    y[125] = Flow_ar_re_co2c13  # [125] Flow_ar_re_co2c13
    y[126] = Flow_ar_re_metc13  # [126] Flow_ar_re_metc13
    y[127] = Flow_ar_sp_apap  # [127] Flow_ar_sp_apap
    y[128] = Flow_ar_sp_co2c13  # [128] Flow_ar_sp_co2c13
    y[129] = Flow_ar_sp_metc13  # [129] Flow_ar_sp_metc13
    y[130] = Flow_gu_li_apap  # [130] Flow_gu_li_apap
    y[131] = Flow_gu_li_co2c13  # [131] Flow_gu_li_co2c13
    y[132] = Flow_gu_li_metc13  # [132] Flow_gu_li_metc13
    y[133] = Flow_he_ve_apap  # [133] Flow_he_ve_apap
    y[134] = Flow_he_ve_co2c13  # [134] Flow_he_ve_co2c13
    y[135] = Flow_he_ve_metc13  # [135] Flow_he_ve_metc13
    y[136] = Flow_ki_ve_apap  # [136] Flow_ki_ve_apap
    y[137] = Flow_ki_ve_co2c13  # [137] Flow_ki_ve_co2c13
    y[138] = Flow_ki_ve_metc13  # [138] Flow_ki_ve_metc13
    y[139] = Flow_li_ve_apap  # [139] Flow_li_ve_apap
    y[140] = Flow_li_ve_co2c13  # [140] Flow_li_ve_co2c13
    y[141] = Flow_li_ve_metc13  # [141] Flow_li_ve_metc13
    y[142] = Flow_lu_ar_apap  # [142] Flow_lu_ar_apap
    y[143] = Flow_lu_ar_co2c13  # [143] Flow_lu_ar_co2c13
    y[144] = Flow_lu_ar_metc13  # [144] Flow_lu_ar_metc13
    y[145] = Flow_sp_li_apap  # [145] Flow_sp_li_apap
    y[146] = Flow_sp_li_co2c13  # [146] Flow_sp_li_co2c13
    y[147] = Flow_sp_li_metc13  # [147] Flow_sp_li_metc13
    y[148] = Flow_ve_lu_apap  # [148] Flow_ve_lu_apap
    y[149] = Flow_ve_lu_co2c13  # [149] Flow_ve_lu_co2c13
    y[150] = Flow_ve_lu_metc13  # [150] Flow_ve_lu_metc13
    y[151] = Qha  # [151] Qha
    y[152] = RenalClearance_apap  # [152] RenalClearance_apap
    y[153] = RenalClearance_co2c13  # [153] RenalClearance_co2c13
    y[154] = RenalClearance_metc13  # [154] RenalClearance_metc13
    y[155] = import_gu_apap  # [155] import_gu_apap
    y[156] = import_gu_co2c13  # [156] import_gu_co2c13
    y[157] = import_gu_metc13  # [157] import_gu_metc13
    y[158] = import_he_apap  # [158] import_he_apap
    y[159] = import_he_co2c13  # [159] import_he_co2c13
    y[160] = import_he_metc13  # [160] import_he_metc13
    y[161] = import_ki_apap  # [161] import_ki_apap
    y[162] = import_ki_co2c13  # [162] import_ki_co2c13
    y[163] = import_ki_metc13  # [163] import_ki_metc13
    y[164] = import_li_apap  # [164] import_li_apap
    y[165] = import_li_co2c13  # [165] import_li_co2c13
    y[166] = import_li_metc13  # [166] import_li_metc13
    y[167] = import_lu_apap  # [167] import_lu_apap
    y[168] = import_lu_co2c13  # [168] import_lu_co2c13
    y[169] = import_lu_metc13  # [169] import_lu_metc13
    y[170] = import_sp_apap  # [170] import_sp_apap
    y[171] = import_sp_co2c13  # [171] import_sp_co2c13
    y[172] = import_sp_metc13  # [172] import_sp_metc13
    y[173] = Flow_ar_li_apap  # [173] Flow_ar_li_apap
    y[174] = Flow_ar_li_co2c13  # [174] Flow_ar_li_co2c13
    y[175] = Flow_ar_li_metc13  # [175] Flow_ar_li_metc13
    y[176] = Flow_re_ve_apap  # [176] Flow_re_ve_apap
    y[177] = Flow_re_ve_co2c13  # [177] Flow_re_ve_co2c13
    y[178] = Flow_re_ve_metc13  # [178] Flow_re_ve_metc13
    y[179] = P_CO2c13  # [179] P_CO2c13
    y[180] = import_re_apap  # [180] import_re_apap
    y[181] = import_re_co2c13  # [181] import_re_co2c13
    y[182] = import_re_metc13  # [182] import_re_metc13
    y[183] = DOB  # [183] DOB
    y[184] = P_CO2Fc13  # [184] P_CO2Fc13
    y[185] = P_CO2R  # [185] P_CO2R

    return y


def f_z(X, T, p):
    """ DataFrame of full timecourse of solution. """
    (Nt, Nx) = X.shape
    Ny = len(yids)
    Nz = 1 + Nx + Ny
    columns = ["time"] + xids + yids
    Z = np.empty(shape=(Nt, Nz))
    Z[:, 0] = T
    Z[:, 1:(Nx+1)] = X
    for kt in range(Nt):
        y = f_y(x=X[kt, :], t=T[kt], p=p)
        Z[kt, (Nx+1):] = y

    Z = pd.DataFrame(Z, columns=columns)
    return Z