Metadata-Version: 2.1
Name: poi
Version: 0.2.4
Summary: Write Excel XLSX declaratively.
Home-page: https://github.com/baoshishu/poi
License: MIT
Keywords: xlsx,xlswriter,excel,declarative
Author: Ryan Wang
Author-email: hwwangwang@gmail.com
Requires-Python: >=3.7,<4.0
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Topic :: Software Development :: Libraries
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Dist: xlsxwriter (>=1.1,<2.0)
Project-URL: Documentation, https://baoshishu.github.io/poi/
Project-URL: Repository, https://github.com/baoshishu/poi
Description-Content-Type: text/markdown

# Poi: Make creating Excel XLSX files fun again.

![travis](https://travis-ci.org/baoshishu/poi.svg?branch=master)

Poi helps you write Excel sheet in a declarative way, ensuring you have a better Excel writing experience.

It only supports Python 3.7+.

[Documentation](https://baoshishu.github.io/poi)

## Quick start

### Create a sheet object and write to a file.

```python
from poi import Sheet, Cell
sheet = Sheet(
    root=Cell("hello world")
)

sheet.write('hello.xlsx')
```

![hello](./docs/assets/hello.png)

See, it's pretty simple and clear.


### Sample for rendering a simple table.

```python
from typing import NamedTuple
from datetime import datetime
import random

from poi import Sheet, Table


class Product(NamedTuple):
    name: str
    desc: str
    price: int
    created_at: datetime
    img: str


data = [
    Product(
        name=f"prod {i}",
        desc=f"desc {i}",
        price=random.randint(1, 100),
        created_at=datetime.now(),
        img="./docs/assets/product.jpg",
    )
    for i in range(5)
]
columns = [
    {
        "type": "image",
        "attr": "img",
        "title": "Product Image",
        "options": {"x_scale": 0.27, "y_scale": 0.25},
    },
    ("name", "Name"),
    ("desc", "Description"),
    ("price", "Price"),
    ("created_at", "Create Time"),
]
sheet = Sheet(
    root=Table(
        data=data,
        columns=columns,
        row_height=80,
        cell_style={
            "color: red": lambda record, col: col.attr == "price" and record.price > 50
        },
        date_format="yyyy-mm-dd",
        align="center",
        border=1,
    )
)
sheet.write("table.xlsx")
```

![table](./docs/assets/table.png)

